#include "AntiSpoofing.h"

#define A(i,j) a[ (i)*lda + (j) ]
#define B(i,j) b[ (i)*ldb + (j) ]
#define C(i,j) c[ (i)*ldc + (j) ]

typedef unsigned int Uint;
typedef unsigned short USHORT;

//卷积层结构体 
typedef struct Conv_Info_ {
    int in_channels;         //输入通道 
    int out_channels;        //输出通道 
    int ksize_h;             //卷积核height 
    int ksize_w;             //卷积核width
    int stride;              //步长 
    int padding;             //填充 
    float* weight;           //权重 
    float* bias;             //偏置 
}Conv_Info;

//特征图
typedef struct Feature_Map_ {
    int channels;
    int width;
    int height;
    float* data;
}Feature_Map;

typedef Feature_Map Tensor;


Feature_Map* ReLU(Feature_Map* X);
Feature_Map* Sigmoid(Feature_Map* X);
Feature_Map* Conv2D_NxN(Feature_Map* X, Conv_Info conv_Info);
Feature_Map* Conv2D_1x1_MY_MMult_4x4(Feature_Map* X, Conv_Info conv_Info);
Feature_Map* Conv2D_1x1_gemm_nn(Feature_Map* X, Conv_Info conv_Info);
Feature_Map* ConvDepthWise2D_gemm_nn(Feature_Map* X, Conv_Info conv_Info);
void gemm_nn(float* left, float* bias, float* right, int L_row, int L_col, int R_row, int R_col, float* Buffer);
Feature_Map* Concat(Feature_Map* X1, Feature_Map X2);
Feature_Map* Bmp2FeatureMap(U_CHAR* img, Feature_Map* X, int height, int width);
void im2col_cpu(float* data_im, int channels, int height, int width, int ksize_w, int ksize_h, int stride, int pad, float* data_col);
//U_CHAR* HistogramEqualize(U_CHAR* img, int width, int height);
U_CHAR* ResizeBiLinear(U_CHAR* img, int ori_height, int ori_width, U_CHAR* out, int new_height, int new_width);
U_CHAR* ResizeCropBiLinear(U_CHAR* img, int oriWidth, int cropWidth, int cropHeight, U_CHAR* out, int new_width, int new_height);
U_CHAR* Filp(U_CHAR* src, int width, int height);
int AntiSpoofingNet(Feature_Map* X, Conv_Info* conv_Info, float threshold);
void FeatureMapCopy(Feature_Map* X1, Feature_Map* X2);
U_CHAR* CropImage(U_CHAR* img, int width, int height, U_CHAR* out, int x_min, int y_min, int box_w, int box_h);
void AddDot4x4(int k, float* a, int lda, float* b, int ldb, float* c, int ldc);

void MY_MMult_4x4_7(int m, int n, int k, float* a, int lda,
    float* b, int ldb,
    float* c, int ldc, float* bias);


const float f0_1_weight[] = { -3.53555e-21,-1.23011e-21,-7.07681e-22,-2.60245e-21,-5.5807e-22,-8.69256e-23,-2.39337e-21,-2.55447e-22,6.38099e-22,5.35388e-23,6.45351e-23,1.93199e-22,1.4377e-23,1.25821e-22,1.81748e-22,9.19083e-23,8.72749e-23,2.3576e-22,1.99668e-22,1.32176e-22,2.30582e-22,2.21408e-22,1.46488e-22,9.63495e-23,8.52886e-23,4.39573e-23,-1.35853e-23,-0.0951124,-0.233243,-0.464219,0.166244,-0.366041,-0.56729,0.443863,-0.0761351,-0.293487,1.76759e-22,3.13769e-22,3.99476e-22,1.59176e-22,2.31882e-22,2.83839e-22,1.12784e-22,1.64441e-22,1.41622e-22,-0.624558,-0.588749,-0.776796,0.0651751,0.258946,-0.324571,0.85989,1.3876,0.751209,-1.53421e-06,-2.76096e-07,3.67849e-08,-1.59722e-06,-7.3626e-07,7.6573e-09,-1.33118e-06,-3.70993e-07,1.20078e-06,1.04768e-22,3.70715e-22,6.52494e-22,-5.14492e-23,4.82339e-22,4.46231e-22,-2.68769e-23,2.3247e-22,1.39006e-22 };
const float f0_1_bias[] = { -9.50197e-12,6.06589e-13,-2.68311e-13,1.00712,-2.56558e-13,-0.0259522,-0.000151875,-7.20297e-13 };

const float f0_2_weight[] = { -9.52781e-21,-4.13317e-21,-4.74529e-21,-2.85575e-21,6.58201e-21,3.62691e-21,3.24725e-22,8.68048e-21,4.25521e-21,1.50738e-21,1.49549e-21,1.72422e-21,1.30398e-21,1.68795e-21,2.08393e-21,2.04358e-21,2.07655e-21,1.74881e-21,-2.97911e-22,-5.16106e-22,-5.06446e-22,-4.98942e-23,2.47824e-24,3.56259e-23,-7.22248e-22,4.55789e-23,1.56572e-22,-0.720116,-0.231047,-0.781578,0.251807,1.7319,0.765794,-1.19736,1.04409,-0.250455,1.35549e-22,-4.73798e-23,4.23743e-23,8.74911e-23,-7.51886e-23,1.74115e-23,2.32508e-23,2.70246e-24,5.63665e-23,-0.244817,0.0897352,0.0667997,-0.96677,0.684619,1.90253,-0.112593,-0.13578,-0.188022,-1.14793e-06,-1.30046e-06,-1.73537e-06,-5.08152e-07,6.60462e-07,2.42696e-06,-1.72192e-06,-3.03155e-07,2.46769e-06,-2.70915e-22,6.04362e-23,-3.8673e-22,-4.30475e-22,3.10968e-24,-1.98983e-22,-1.34176e-22,1.8685e-22,-1.18825e-22 };
const float f0_2_bias[] = { 4.72995e-12,-2.43492e-12,-2.63809e-12,-0.142684,-1.49712e-12,0.0387955,-2.34861e-05,-1.06702e-12 };

const float f1_1_weight[] = { -2.82642e-23,1.41267e-23,5.05858e-24,2.92283e-23,-3.10398e-23,-9.33317e-24,-9.98911e-25,1.7472e-23,-3.49643e-24,9.25095e-24,-2.12802e-24,1.23045e-23,1.00002e-23,1.09056e-23,1.1997e-24,6.8477e-24,1.09118e-23,-2.40963e-23,7.38149e-23,6.67747e-23,1.37904e-22,1.18945e-22,2.61777e-22,1.37847e-23,1.64687e-11,-8.62643e-13,-1.42851e-12,0.582058,7.65814e-13,-1.23819,7.12172e-05,-2.21179e-12,-8.61332e-14,-4.5972e-14,6.456e-14,-1.02992e-05,-2.45019e-15,-4.13355e-06,5.22654e-06,-7.21064e-14,6.1585e-12,-8.28546e-13,2.21095e-12,0.603281,9.08849e-14,-0.593683,0.000118638,1.74904e-12,-1.13647e-22,1.42576e-23,5.37622e-23,2.41682e-22,-1.20544e-23,9.31793e-23,1.31595e-22,4.28758e-23,4.63801e-24,5.6021e-25,-9.59096e-24,2.78781e-23,-2.15472e-25,-1.57437e-23,1.05909e-23,1.15672e-23 };
const float f1_1_bias[] = { -6.56405e-13,-1.44394e-12,-1.23215e-13,1.54783,3.96174e-05,0.381875,2.0934e-15,-1.40197e-12 };

const float f1_2_weight[] = { -1.13751e-22,2.63189e-23,-5.383e-24,-1.24296e-22,6.32405e-23,-1.71041e-23,-1.01762e-22,6.47348e-23,-3.07278e-24,5.62261e-23,-2.13515e-23,-3.09215e-23,8.29346e-23,-2.98256e-24,2.65679e-23,-6.41151e-23,3.93755e-24,-3.94567e-23,2.59564e-24,-1.55981e-24,-5.24485e-24,4.99157e-25,-9.59236e-24,-6.22801e-24,-1.09e-23,-6.88471e-24,-1.35878e-23,-0.156654,-0.150309,0.192966,-0.166238,-0.343551,0.07103,-0.0732194,-0.167501,0.0218374,3.06791e-07,8.06732e-07,-2.20571e-07,7.55912e-07,1.03702e-06,-2.3897e-07,1.1074e-06,5.09041e-07,-5.999e-07,-0.0726178,-0.244279,0.693391,-0.0784492,0.245561,1.0088,0.00218135,0.100586,0.205491,1.11983e-23,-3.84009e-23,-1.07095e-23,-3.28417e-23,-7.275e-25,-1.77023e-24,3.83678e-23,3.88548e-23,3.49356e-23,-8.43582e-22,-1.56248e-22,2.66388e-22,-5.61345e-22,-1.58921e-23,1.49059e-22,-4.70558e-22,4.6424e-24,3.83903e-23 };
const float f1_2_bias[] = { 2.67223e-13,2.93858e-13,-5.42275e-13,1.23313,-0.000195788,-0.328447,-1.69384e-12,-1.87555e-12 };

const float f2_1_weight[] = { 2.75224e-23,-1.64671e-23,-1.20771e-23,2.44711e-23,-1.36054e-22,-1.22964e-22,-1.44253e-23,1.41724e-22,1.24374e-23,1.72067e-24,6.2894e-23,1.04514e-22,1.05191e-23,2.82417e-23,5.02799e-23,8.51321e-23,8.50202e-13,1.4285e-13,2.06621e-12,-0.993613,-0.000134519,-0.784048,4.77745e-13,-1.81524e-13,6.56234e-24,1.36305e-23,5.18415e-24,2.94779e-23,-1.85586e-24,1.32367e-23,-2.14614e-23,5.71788e-24,1.86047e-23,1.37774e-22,1.3838e-22,7.98109e-23,-9.55732e-23,-4.31706e-23,-8.76141e-23,-1.24726e-22,2.06326e-21,2.04701e-21,-4.78991e-21,-1.73712e-19,-4.18629e-20,8.01309e-20,-1.74432e-21,-3.61382e-21,8.21362e-23,-1.02577e-22,2.34883e-23,-1.07709e-22,1.13641e-22,9.65869e-23,5.85916e-23,3.02958e-23,1.27196e-13,-2.97754e-13,-3.35647e-13,-0.483355,-9.02659e-05,0.102537,-6.94223e-13,3.79572e-13,-8.82884e-13,-8.01772e-13,1.0587e-12,0.354396,0.000181796,1.23018,5.32e-13,-8.7573e-14,1.36951e-24,-4.77299e-24,-1.52883e-24,1.35325e-23,-5.41007e-24,8.18341e-24,-1.20995e-23,-5.78684e-24,1.36542e-12,1.54998e-12,1.29464e-12,1.51272,0.000137078,-0.435224,1.89677e-12,-1.58456e-12,-9.47442e-25,-9.51658e-24,8.56744e-24,1.27296e-22,1.7868e-22,8.64592e-23,9.25245e-23,1.24681e-22 };
const float f2_1_bias[] = { 3.37544e-13,-1.24751e-12,1.10432,-8.65039e-13,2.90974e-13,-6.70524e-11,-3.37626e-13,0.674108,-0.508227,-9.78282e-13,-1.49129,1.95531e-13 };

const float f2_2_weight[] = { 1.15109e-23,-3.70445e-26,-1.46899e-23,-8.09041e-24,-1.69604e-23,-2.48133e-23,-1.75203e-23,-2.73171e-23,-2.19957e-23,-3.5536e-23,7.85543e-24,-2.9957e-23,-1.22941e-23,-3.32756e-24,-3.61653e-23,-3.95152e-23,-4.25599e-23,-3.10907e-24,-0.992512,-0.866417,-0.383065,-0.00327137,-0.199335,-0.327539,1.00849,1.28571,0.328293,-1.47084e-24,1.99393e-22,4.00211e-22,-4.56726e-23,1.72072e-22,1.02071e-22,4.70596e-23,1.16081e-22,1.26327e-23,-2.12516e-23,-4.31476e-23,-4.32778e-23,-3.46277e-23,-2.35643e-23,-8.88399e-24,-8.61882e-24,1.34315e-24,-3.60067e-23,7.88036e-20,-1.48612e-19,-7.78057e-20,2.8439e-19,5.26748e-19,2.09817e-19,2.81027e-19,5.11291e-19,9.48057e-20,-3.14973e-23,-6.61751e-24,1.24458e-23,-7.82477e-24,4.28181e-24,-1.30682e-24,6.93352e-24,-1.09368e-24,-1.37601e-23,0.220446,-0.170113,-0.333414,-0.00279271,-0.512323,-0.491694,-0.331204,-0.369958,0.0580714,0.0444428,-0.0422797,-0.0634769,0.328089,0.386938,0.230558,0.153594,0.325839,0.395375,5.64777e-22,3.70062e-22,3.29173e-22,4.61982e-23,3.09367e-22,1.8095e-22,-1.25355e-22,8.63503e-23,-1.93046e-23,-0.305921,-0.433452,-0.215465,0.0792059,-0.279753,-0.823805,0.555036,-0.181852,-0.547851,-4.13139e-24,-3.14634e-24,-2.21449e-24,-2.80756e-24,-4.06794e-24,-3.30047e-24,-9.83518e-24,-1.59069e-23,-1.28962e-23 };
const float f2_2_bias[] = { -3.29997e-13,1.24319e-12,0.0318554,-2.79989e-14,-5.35806e-13,-3.49096e-11,-9.44346e-13,1.47129,0.0179875,4.9188e-13,0.712413,-7.04521e-13 };

const float f3_1_weight[] = { -1.76023e-17,-1.23941e-18,-3.00057e-11,1.49019e-17,-4.29659e-17,3.14503e-15,1.57738e-17,-2.09686e-10,6.16878e-11,1.87169e-19,-8.22044e-11,1.48596e-17,8.38953e-23,-1.1546e-22,-1.87115e-22,-1.42727e-22,-1.16363e-23,-8.88275e-23,2.7158e-22,4.06792e-23,-2.60597e-22,-1.65503e-22,-4.38272e-24,-3.61957e-23,-2.03984e-23,-1.91766e-23,-6.52899e-26,3.91935e-23,-5.66594e-24,2.78388e-25,-8.00957e-24,1.12444e-23,-2.33193e-23,4.73633e-23,-1.41325e-23,-1.01063e-24,3.60103e-13,-2.43852e-13,-0.211115,5.8864e-13,3.063e-13,5.13448e-11,6.0114e-13,0.470555,0.943271,1.43224e-12,-0.488437,1.00647e-12,-4.92187e-24,1.69869e-23,-1.02782e-23,-4.41904e-24,8.88056e-24,-5.87701e-25,-2.6256e-24,6.1387e-23,6.10592e-23,4.76295e-23,-6.0401e-23,2.16509e-23,-7.58535e-14,6.6284e-13,-0.525942,3.44247e-14,1.9281e-13,-1.67014e-11,-1.86208e-13,-0.00261373,-0.0546283,-4.32568e-13,0.160169,-1.7639e-13,3.51617e-13,2.51593e-14,-0.109077,-1.19703e-12,8.12878e-13,-1.57016e-12,-6.78808e-14,-0.565454,0.127321,-6.44377e-13,0.226319,-2.72017e-13,-2.3146e-22,3.90447e-22,-1.83751e-21,1.85189e-22,1.59601e-22,-5.17686e-21,-8.5444e-22,-5.88273e-21,-1.18173e-20,3.54893e-22,-3.26187e-22,-2.92938e-22,-2.37104e-24,-1.33666e-23,3.16542e-24,6.86837e-24,3.57342e-24,-6.45483e-26,4.62121e-23,8.08844e-23,3.69004e-23,1.94983e-23,1.74254e-23,-2.49605e-23,-7.0372e-23,2.04753e-23,6.21371e-23,3.86659e-23,-2.73417e-23,3.08177e-23,-7.64915e-24,-1.03831e-22,5.96673e-23,-9.38993e-24,-1.22968e-23,-1.50752e-24,5.4164e-23,1.76977e-23,7.05192e-23,5.40607e-24,1.37789e-23,1.15811e-22,1.03565e-22,-9.01761e-23,3.61908e-23,-2.90893e-24,1.1412e-23,6.35668e-23,-1.08853e-12,4.00731e-13,0.0518403,-2.87839e-13,1.70985e-13,2.3629e-11,-4.62562e-13,-0.877224,0.0175196,-6.51338e-13,0.194598,-5.57009e-13 };
const float f3_1_bias[] = { -3.44405e-06,-1.16458e-12,-1.85105e-12,0.0926688,-2.2761e-12,0.398516,0.681854,-1.31326e-11,-1.32133e-12,-3.4348e-12,1.25627e-13,1.04214 };

const float f3_2_weight[] = { -3.33505e-10,-7.19108e-10,-9.44128e-10,5.35655e-11,-8.60086e-10,-9.2815e-10,-1.10274e-09,-1.68154e-10,4.33597e-10,8.29458e-23,2.42476e-23,9.93005e-23,1.29769e-22,4.35477e-23,-3.15539e-23,8.24604e-23,-4.90322e-23,1.19984e-22,1.05116e-22,2.04164e-22,2.7779e-23,5.83132e-23,1.0994e-22,1.15388e-22,1.87332e-22,2.62927e-22,2.48989e-22,-0.202733,-0.702731,0.0302498,0.7536,1.44186,-1.4365,0.313499,0.421299,-0.179344,3.82027e-22,1.4713e-22,5.80815e-22,8.42824e-22,-2.06214e-22,-6.16893e-22,1.82898e-22,-2.07736e-22,-1.33178e-22,-0.415115,0.634684,-0.113868,0.873964,0.951155,-0.000362417,0.501983,-0.0292181,-0.0762745,0.650549,0.273759,-0.272464,1.14822,-0.1353,-0.905839,0.545097,0.0478287,-0.972692,-2.29721e-20,2.59548e-20,1.94405e-20,-3.11343e-20,1.72135e-20,6.12095e-20,-1.29476e-20,1.0281e-20,3.09713e-20,2.96758e-23,3.69715e-23,6.79019e-23,9.79664e-23,9.12668e-23,1.75592e-22,-1.40292e-23,2.31786e-23,8.74585e-23,3.76561e-22,-2.2499e-22,2.16345e-21,1.22275e-21,-1.83892e-21,-8.96465e-22,1.46262e-22,-1.39047e-21,-6.35684e-22,-3.11146e-25,-4.71361e-23,3.06599e-25,-4.16213e-23,2.16347e-24,-2.55181e-23,7.07049e-24,3.26781e-23,-5.3315e-23,-0.0607917,-0.281109,-0.0423363,-0.212986,-0.433757,-0.0783877,-0.15349,-0.0909401,0.140809 };
const float f3_2_bias[] = { 4.25992e-06,1.90777e-13,-2.26225e-13,-0.184585,1.35622e-12,-0.69511,0.0219429,-7.77215e-12,6.75002e-13,6.04602e-13,-4.06701e-13,1.42691 };

const float f4_1_weight[] = { -3.43786e-23,-4.53475e-23,3.20208e-23,-4.45994e-23,-1.85844e-23,-1.91532e-23,-1.02259e-23,1.25752e-23,-1.45314e-22,-3.69881e-23,8.22923e-23,2.07141e-23,-1.3828e-06,-5.59619e-14,6.81535e-15,0.480303,-3.30093e-14,-0.569996,0.00421962,8.56255e-12,-2.86858e-13,1.43709e-12,-6.82857e-14,0.168485,6.86979e-24,2.2691e-23,2.27433e-23,1.49409e-23,-6.42096e-24,-2.25116e-23,1.27826e-23,-1.15025e-23,3.9471e-24,1.92315e-23,2.06865e-24,2.15658e-23,-5.57476e-24,1.65246e-23,5.11164e-24,7.03609e-25,-1.50086e-24,-1.01372e-23,-2.76823e-25,6.37115e-24,8.77762e-24,-1.1017e-23,-4.69364e-24,-3.93398e-24,-4.82962e-26,1.95251e-25,-3.29772e-25,2.72468e-25,1.83362e-25,2.66115e-25,3.8929e-25,2.10584e-25,-2.87202e-25,8.91474e-26,-1.01378e-25,1.53409e-25,-4.14668e-23,-9.59981e-23,4.37832e-23,5.54402e-24,-9.03162e-23,-1.20444e-22,-1.38675e-23,-7.62526e-23,-8.90696e-23,1.78976e-23,3.48884e-23,-2.76017e-23,5.41791e-07,1.24522e-12,1.89134e-12,0.809767,2.95361e-12,0.604575,-0.11994,1.65355e-12,2.01617e-12,1.62527e-12,6.94936e-13,0.787217,-1.62422e-22,-9.61297e-24,1.21464e-22,2.64714e-23,-3.98241e-23,-5.20088e-23,-2.63483e-23,1.77953e-22,-1.97033e-22,-3.48129e-23,1.30253e-22,-1.06109e-23,-2.50687e-06,-3.91093e-13,1.52165e-13,-0.107582,8.63136e-13,0.0403109,-0.563184,-1.10459e-11,-3.11412e-13,8.08346e-14,2.1196e-13,-0.0525626,4.44917e-06,-4.35688e-13,-1.6663e-13,-0.453223,4.472e-13,0.091655,-0.39191,-1.20527e-11,-9.91061e-13,9.38875e-13,4.14197e-13,-0.326771,-1.78887e-06,2.39599e-14,-5.61009e-13,0.0649714,7.57339e-13,-0.0274793,0.191314,7.40544e-12,-5.93935e-14,2.01381e-12,3.27552e-13,-0.647337,-3.47366e-22,-1.69459e-23,-1.20829e-22,-1.60721e-21,3.66854e-23,-5.51601e-21,-3.2482e-21,-1.91996e-21,-8.28004e-23,4.55709e-22,2.22137e-22,2.6191e-21,-2.39936e-24,-1.33496e-23,-3.86581e-23,-5.91368e-23,-2.73954e-23,-1.16219e-22,-6.45155e-23,-6.30033e-23,7.20944e-23,-2.14771e-22,3.29255e-23,4.50627e-23,-3.98011e-23,-3.29644e-23,-8.09223e-23,5.75939e-24,2.67813e-24,-9.35833e-23,-1.27116e-22,-6.06209e-23,-8.23124e-24,1.87713e-23,-8.3402e-23,1.17933e-22,-3.71135e-23,2.47869e-25,3.27806e-23,-6.71496e-23,2.91659e-23,-7.10587e-23,-4.69296e-24,-1.12686e-22,-7.96991e-23,-1.35594e-23,5.43099e-23,4.45167e-23,-1.01813e-06,2.21701e-13,8.42072e-14,0.103146,6.08517e-13,0.0283482,-0.0581975,-3.81997e-12,-5.26865e-13,1.02927e-12,2.84776e-13,-0.41104 };
const float f4_1_bias[] = { 3.91121e-13,0.241342,-1.15056e-12,-7.11115e-13,-6.51996e-13,5.50429e-13,-0.957961,9.65597e-14,0.5381,0.595903,0.98971,-1.26811e-11,6.61986e-14,2.1177e-14,1.3968e-14,0.592825 };

const float f4_2_weight[] = { -5.55602e-24,1.85439e-23,2.0637e-23,-3.75557e-24,-1.11919e-23,-1.24144e-23,-1.2601e-23,-1.50069e-23,-1.40517e-23,-0.25739,-0.240887,-0.467534,-0.124787,-0.601197,-0.613359,-0.184675,-0.290655,-0.246459,8.46086e-23,3.18063e-23,1.07389e-22,1.23644e-23,-7.02932e-24,7.33298e-23,-5.15916e-23,3.21825e-23,-4.79988e-23,-1.56256e-23,-3.00622e-23,-3.37978e-23,-2.5631e-23,4.78504e-24,2.13316e-23,-2.03357e-23,-2.06579e-23,-4.83455e-23,-4.82781e-23,2.72826e-23,-3.88093e-24,-5.98099e-23,-1.87845e-23,1.45451e-24,-8.39097e-23,4.21316e-23,7.80059e-23,1.028e-23,-5.60936e-23,-7.28691e-23,-5.95342e-23,-3.24984e-23,1.27742e-23,-5.27128e-23,-2.41824e-23,-2.14331e-23,0.0544108,0.234227,0.200963,0.166487,0.379732,0.446608,0.148068,0.23741,0.0655547,-3.80631e-23,-1.56441e-23,5.77469e-24,-1.87965e-23,-3.94156e-23,1.65027e-23,-3.92896e-25,1.54156e-23,-7.01999e-23,0.291614,0.465831,0.236937,0.182496,0.706455,0.276556,0.656703,0.758032,0.287012,0.432939,0.94923,1.25282,-0.462085,-0.494041,-0.127646,-0.435522,-1.23134,-0.662015,0.590432,0.873561,1.14495,0.24536,0.305973,-0.21604,-0.601729,-1.14985,-1.13318,-9.91545e-21,7.06465e-21,1.5878e-20,-1.34447e-20,4.0256e-21,1.74725e-20,-5.29124e-21,3.55765e-21,-2.97854e-22,7.73673e-24,-3.05059e-24,-8.50134e-25,5.53954e-24,1.72885e-24,-1.16923e-24,8.27447e-24,7.06205e-24,6.26009e-24,-5.3106e-24,-2.98628e-23,-2.78507e-24,-2.55423e-23,-8.69099e-24,-6.46818e-25,6.8058e-24,7.71698e-24,1.30741e-24,-4.27231e-24,4.67048e-24,5.36336e-24,-7.53046e-25,6.62203e-25,-1.67894e-24,1.66339e-24,4.40955e-25,-1.49799e-24,-0.144233,-0.382067,-0.0274046,-0.0126676,-0.951031,-1.16639,0.357874,-0.299294,0.066368 };
const float f4_2_bias[] = { -3.30654e-13,1.36357,-1.7757e-13,5.28124e-13,3.1752e-13,-3.898e-13,0.0244232,-4.72243e-13,-1.09586,0.203685,0.641247,2.86778e-12,-2.38675e-13,-2.98588e-13,-5.34129e-13,1.31274 };

const float f5_1_weight[] = { -2.11653e-26,-3.89213e-26,9.14717e-26,-4.66836e-26,-3.43405e-26,-5.40889e-26,1.39981e-25,-2.52824e-26,-2.35974e-27,-6.93348e-26,-7.35075e-26,6.7734e-26,-3.8542e-26,-1.68496e-26,1.69255e-27,2.50818e-26,6.84791e-13,-0.321914,-1.95952e-13,-3.25358e-13,-4.68506e-13,5.09931e-14,0.313759,6.98579e-13,0.470475,0.0247193,-0.244411,2.61845e-12,-5.2745e-13,3.69321e-13,1.77236e-13,0.123765,-3.69254e-13,-0.0306904,1.44132e-13,1.14362e-15,1.61831e-12,-5.82084e-13,-0.254936,-6.36563e-13,0.0810102,0.0595601,0.910568,-1.24142e-12,7.37696e-13,-1.92303e-13,-5.78651e-13,0.244158,4.10745e-24,-1.3956e-22,-6.26765e-23,-2.09266e-23,4.42345e-23,7.63593e-23,-1.3e-24,-3.7574e-23,-2.07188e-23,-4.58818e-23,-8.41716e-23,5.2892e-23,-6.14873e-23,1.07398e-23,-3.13487e-23,1.0006e-23,-1.17712e-15,-1.24853e-07,-6.15952e-16,-6.26168e-16,8.40631e-16,5.89389e-16,2.80514e-08,7.88171e-16,2.11495e-08,5.68366e-08,-8.76501e-09,1.8692e-14,1.34168e-16,-6.20628e-16,-5.48547e-17,3.73936e-07,1.73165e-13,0.0628326,-1.8397e-13,1.45273e-12,-8.66662e-13,7.53935e-13,0.0240267,-6.14981e-13,0.650524,0.339449,-0.00856855,-8.78401e-12,4.9595e-13,-4.82031e-13,-1.40348e-13,-0.731826,-5.93514e-14,0.47172,-7.97204e-13,-5.04332e-14,6.60444e-14,2.98355e-13,0.0976447,-7.44514e-14,-0.138803,-0.23078,-0.240039,-6.79595e-13,1.62125e-13,-3.01066e-14,-1.34995e-13,-0.367791,5.44561e-14,-0.291636,3.46391e-13,-4.58599e-13,-1.74028e-13,4.8288e-13,-0.248782,2.9815e-14,0.125251,-0.133336,-0.392213,2.69971e-12,-5.27018e-13,-5.03388e-13,2.93012e-13,0.227753,-4.92284e-13,0.196738,-1.74536e-13,4.08385e-13,3.53349e-13,3.24192e-13,-0.29325,3.02928e-13,0.0869621,0.11026,-0.0260048,-1.21736e-12,-1.21515e-13,-2.70258e-13,-3.69311e-13,-0.255901,1.97979e-13,0.0252737,-7.40394e-13,3.67569e-13,6.0971e-13,1.85232e-13,-0.0018262,3.56682e-13,-0.552316,0.281629,-0.0127675,3.73839e-12,2.71578e-13,-8.25842e-13,1.90277e-13,0.461172,-5.13765e-13,-0.242066,5.34195e-13,-1.94545e-12,4.28192e-13,-4.05816e-13,0.807913,1.08516e-12,-0.0434778,-0.132159,-0.337605,1.81585e-12,1.02084e-12,7.38123e-13,1.60044e-13,-0.648257,-2.04495e-13,-0.0832422,1.21779e-12,1.25505e-13,-9.32778e-13,2.45599e-13,0.12068,4.76447e-13,0.0554053,0.0952907,-0.829925,7.40924e-12,-2.24938e-13,-1.62149e-13,5.54688e-13,-0.429476,1.44652e-13,0.540994,-1.67826e-13,-4.89587e-13,-5.60258e-13,-7.345e-13,0.0614986,1.42163e-13,-0.0490486,-0.0690024,0.660592,-2.53442e-12,1.6061e-13,6.58336e-13,-1.50407e-12,-0.184756,-1.51299e-13,-0.440656,2.03838e-13,6.79579e-13,2.93851e-13,-2.50847e-13,-0.375391,-7.24335e-13,0.0767272,0.139205,0.111793,-3.60197e-12,3.5348e-13,-4.26543e-13,-4.94551e-13,-0.46013,-3.10514e-13,-0.245946,-2.05907e-13,-1.8497e-13,-2.16634e-13,7.34977e-13,0.261969,-1.60261e-13,-0.517611,0.141244,0.199317,3.40816e-12,6.25569e-13,-4.57423e-13,-1.02693e-13,-0.290059,2.52584e-13,-0.578387,-2.80598e-13,-6.81782e-14,-4.94056e-13,2.72632e-13,-0.523905,7.73262e-13,-0.0543593,-0.526636,-0.502708,5.40779e-12,3.79917e-13,-3.27367e-13,6.37638e-13,-0.312839 };
const float f5_1_bias[] = { -1.04352e-12,-0.0254251,-0.753499,-2.16528e-13,-0.000140347,0.448387,0.578774,0.475561,0.48649,0.150542,0.362417,0.826982,-0.275028,0.862061,0.663224,1.16217 };

const float f5_2_weight[] = { -1.59784e-24,3.4775e-22,-4.17724e-23,-6.11029e-23,6.66147e-23,1.33076e-23,-9.3134e-23,-4.33823e-23,-1.1226e-23,0.467301,0.192645,-0.211329,1.29096,0.796805,-0.0146136,0.88944,-1.79789,-0.737013,-0.815211,-0.757754,0.509695,0.448091,0.731773,-0.31101,1.06368,0.2812,-1.27362,-2.27366e-25,1.42219e-24,1.6279e-24,1.52622e-24,3.86572e-24,3.02826e-24,2.02797e-24,-6.29234e-25,-3.3249e-25,-1.18348e-06,-3.02495e-07,-9.64157e-07,4.86828e-07,3.77067e-07,6.90177e-07,7.83054e-07,2.56236e-06,1.05064e-06,-0.24003,0.651583,0.0834025,-0.232933,0.772959,-0.00465212,-0.936322,0.448648,0.0897236,-0.108236,-0.046657,-0.0127072,0.244905,0.20882,-0.284831,0.429729,0.705632,0.0865517,1.12642,0.226976,-0.214311,0.454668,1.37522,0.0683101,-0.621947,-0.340804,0.13012,-0.836784,-0.242283,0.448433,-0.323656,0.0469159,0.616691,0.307332,0.0473029,0.42328,-0.719842,0.243157,0.409405,-0.447854,0.382789,1.07028,-0.651624,-0.327176,0.333656,0.35258,1.04013,0.926088,0.226831,0.256893,-0.65293,0.702022,0.148295,-0.0612106,0.141525,-0.186224,0.0978526,0.0111636,-0.618039,0.379435,-0.0391489,1.9852,-0.154007,-0.081492,0.548087,0.519135,0.0266679,0.284371,0.444906,-0.237422,-0.553666,-0.795637,0.538617,0.210185,-0.663184,0.885202,0.93717,-0.301087,-0.129628,-0.238567,0.0651024,0.268381,0.454332,0.316845,-0.433741,-0.874651,-0.302011,-0.322366,-0.368871,0.0124801,0.0357712,-0.0850779,-0.938402,-0.0838689,-0.614636,-0.0199831,-0.54868,-0.275164,0.18978 };
const float f5_2_bias[] = { -5.15045e-13,-0.121309,0.0481362,-2.7342e-13,-8.57318e-05,-0.0468904,0.0698679,-0.512899,0.200255,0.0881472,0.0179504,-0.0366028,0.184989,0.00637984,0.808211,0.440347 };

const float f6_1_weight[] = { 2.42229e-23,4.04871e-23,-2.50949e-22,-4.5925e-23,3.02997e-22,-6.2976e-22,8.38741e-22,3.47136e-22,-7.89243e-22,-1.09806e-22,-1.73891e-22,-1.71587e-22,2.19377e-23,-7.80096e-23,1.27684e-22,4.74589e-23,1.7081e-15,-3.604e-07,2.15181e-08,-5.37101e-15,-1.95495e-07,-3.52479e-06,-3.29897e-07,-8.55658e-07,3.43673e-06,-3.81881e-06,5.8964e-07,-1.03769e-06,2.09983e-06,-2.66166e-06,-7.55826e-07,9.07579e-07,1.30619e-17,1.35488e-11,3.5465e-11,2.58136e-17,2.70395e-12,1.49597e-11,-3.39949e-11,-8.31221e-12,5.65359e-11,1.58207e-11,-5.6942e-12,1.09191e-11,-9.03476e-12,4.50405e-11,1.57197e-11,-1.49526e-11,1.28611e-20,3.32878e-18,5.48513e-18,-1.51015e-20,2.27816e-17,1.79148e-18,-1.15643e-17,-8.16725e-18,-7.21472e-18,-2.26244e-17,-2.74845e-18,2.34192e-18,1.29286e-17,-1.07759e-17,-9.93796e-18,1.67195e-18,-1.80723e-15,1.11719e-05,2.05404e-05,7.14894e-15,-3.15258e-07,8.97101e-06,-0.000130147,-1.85685e-05,-1.44231e-05,4.33939e-05,1.00623e-06,-1.34315e-05,2.93268e-05,1.31732e-05,-1.38728e-05,-1.8456e-05,-9.24641e-14,0.00537716,0.256449,3.63559e-13,2.99487e-05,-0.315322,0.209336,0.181354,-0.0227067,-0.268254,0.239334,0.291135,0.7561,-0.145314,0.303458,0.0863943,-4.06083e-23,-6.74983e-24,-3.65458e-23,3.04375e-23,-1.63827e-22,8.22453e-24,5.19925e-24,1.57401e-23,2.12918e-23,-2.38717e-23,-2.06953e-23,-4.35807e-23,4.04403e-23,-8.75608e-24,-9.54662e-24,2.7885e-23,-1.13614e-13,-0.0691684,0.0479025,2.10968e-13,-1.43602e-05,-0.0474618,0.258994,0.0245902,0.331635,-0.0227666,-0.0286843,0.0421999,-0.0753737,0.254072,0.0165057,-0.106843,-5.53994e-13,0.00401093,0.121892,5.59156e-14,-1.62362e-05,0.188669,-0.0837835,0.038276,-0.0706566,0.187767,0.0501002,0.0204844,-0.0180186,-0.0929085,-0.309435,-0.0521447,9.44158e-17,-5.80044e-10,-2.48917e-10,1.88455e-16,-1.51939e-09,-1.2262e-09,2.41158e-10,1.89223e-09,1.15543e-09,-2.48605e-09,-1.63691e-09,7.15463e-11,-8.99027e-10,-1.51527e-09,2.42836e-09,-3.27219e-09,-4.62996e-13,0.275401,0.00991992,7.19747e-14,6.46837e-06,0.379863,-0.139929,0.0296232,0.426832,-0.399865,-0.118698,-0.0551322,0.136721,-0.158724,-0.0164097,0.0493822,-5.34e-24,3.27021e-23,-3.90753e-23,9.67725e-24,1.89515e-22,-2.67027e-23,2.48849e-22,-8.45306e-24,1.54999e-22,5.54357e-22,-1.59398e-22,-1.23437e-22,-1.05991e-22,1.9075e-22,-1.89256e-23,-1.1883e-22,-8.07707e-14,0.0253138,-0.0366252,3.15889e-14,5.48695e-05,0.00894288,-0.136655,-0.00413466,-0.0431018,-0.0400287,-0.0292613,-0.0273196,0.0289308,-0.056371,0.00715244,0.0204742,1.05127e-13,0.00522845,-0.340123,-3.76352e-14,-4.97621e-06,-0.126744,0.485058,0.0116111,-0.168131,0.137121,0.103009,-0.160593,-0.195118,-0.302269,0.0275362,0.148926,3.70942e-23,-6.16947e-24,5.24051e-23,5.29322e-23,2.85241e-23,3.79892e-23,4.82872e-23,4.87111e-23,2.89697e-23,-3.05505e-23,9.3561e-23,-1.68021e-23,-6.30252e-24,-4.5398e-23,7.84672e-23,1.76568e-24,-3.65129e-21,-1.10064e-19,9.97373e-20,-1.53567e-21,1.27636e-19,7.45221e-20,-3.69744e-19,-2.03851e-19,1.4353e-19,-3.706e-19,3.79141e-19,-1.71725e-19,-9.19504e-21,-4.78046e-19,1.82261e-19,2.91514e-19,3.9537e-13,-0.0332784,0.44585,-1.31739e-13,2.19082e-05,-0.251216,0.0551564,-0.00039048,-0.28237,-0.354185,-0.180528,-0.0699413,0.0173118,0.515305,0.243001,0.52147,5.07978e-13,0.274211,-0.172559,-1.20552e-13,-1.51356e-05,-0.100477,0.224989,-0.136757,0.0760757,0.0187412,-0.0667828,0.215749,0.091895,-0.44304,0.271195,0.0804598,5.26546e-13,0.236818,-0.0068285,-3.2918e-14,-6.49233e-05,-0.415894,0.175911,0.571377,0.180387,-0.629608,-0.296032,0.134655,-0.384237,-0.00864064,0.352912,-0.130372,-2.31411e-13,0.194081,0.232569,-1.91978e-13,6.84628e-05,0.0812113,-0.475579,0.326536,-0.128127,0.258792,-0.379979,-0.0910245,-0.594687,0.421195,-0.391585,0.0359038,-8.48495e-13,0.0409728,0.215866,-1.42243e-13,-1.83766e-05,-0.211252,-0.242811,0.0552288,0.294796,-0.0584757,-0.183081,-0.326991,-0.470504,-0.009673,0.326842,-0.263084,2.39094e-19,-2.95569e-16,-2.66753e-15,-1.46674e-19,6.06942e-15,2.29751e-15,6.02276e-16,-1.61775e-15,-4.32204e-15,-3.85996e-15,-1.66511e-15,1.62652e-15,1.97814e-15,-2.14664e-15,-2.53486e-15,1.18527e-15,8.91589e-14,0.202906,0.014822,-1.69653e-14,-1.76592e-05,-0.175335,0.0696971,-0.280015,0.222553,-0.0170368,0.353851,0.0507713,-0.133909,0.29747,-0.193973,0.165747,-7.08735e-15,-0.158851,0.156542,1.68907e-13,-3.716e-06,-0.0797446,-0.259723,-0.142654,0.103395,0.0572924,0.371773,0.00726562,-0.179511,0.190529,0.139635,-0.118915,-1.59953e-22,-4.98151e-21,-5.54928e-22,-5.36832e-23,8.20805e-21,3.30481e-21,-1.25815e-21,-4.9688e-21,-2.93594e-21,-5.97439e-21,3.80373e-21,1.83743e-21,8.44082e-22,-2.38756e-21,-3.1585e-21,2.10691e-21,-4.98888e-20,4.84628e-16,-1.06961e-15,2.92517e-20,1.96732e-16,-1.23716e-15,3.80606e-16,3.06963e-15,6.56692e-16,2.74297e-16,-3.0558e-16,-6.37559e-16,3.11526e-16,-1.90565e-15,2.38422e-16,-2.27672e-16,7.65438e-13,-0.264895,0.111214,1.3702e-13,-4.33359e-05,-0.0814122,0.370594,0.193905,-0.0196992,0.101649,-0.395332,-0.0267491,-0.0601608,0.419356,0.163616,-0.204193,-9.87308e-13,-0.0273989,0.182254,-4.74762e-13,-6.09231e-06,-0.174332,-0.144604,-0.290146,-0.0208136,-0.0545094,-0.210146,0.956158,0.0069633,-0.0760855,-0.0302505,0.216672,6.19897e-21,2.10865e-18,2.86243e-18,-3.44598e-21,-2.15408e-18,2.13047e-18,-4.19958e-18,-3.26049e-18,-2.10097e-18,-1.80688e-18,6.85419e-19,2.73948e-18,4.11206e-18,1.32194e-18,1.40054e-18,-5.46456e-18,-4.14171e-13,-0.517181,-0.311566,1.01288e-13,-4.79613e-05,-0.410218,0.192777,-0.236585,-0.319247,-0.26547,0.286221,-0.0443895,-0.0796891,-0.491695,0.629092,0.275136,1.91398e-23,6.0082e-23,7.13749e-24,1.11804e-23,-4.4494e-23,-2.8281e-23,6.20952e-23,3.36708e-23,3.40338e-23,5.38594e-25,-3.71195e-23,-7.61835e-24,4.80525e-23,-4.37274e-23,2.22304e-23,-3.8091e-23,-5.40674e-24,-3.86428e-23,-6.79711e-23,2.71429e-23,-1.67578e-23,1.20354e-23,-3.29936e-23,8.96432e-24,6.50462e-26,9.95729e-23,5.93112e-23,-6.5504e-23,-8.56607e-24,3.315e-23,-2.74108e-24,-2.50393e-23 };
const float f6_1_bias[] = { -5.50486e-12,-0.000428121,-1.24443e-06,-9.09415e-10,-0.00143225,-0.337054,-1.22713e-12,0.0146728,0.411067,-7.35672e-06,0.143358,-1.52737e-11,-0.10138,0.238019,3.67521e-14,7.11655e-11,-0.347304,0.0208457,0.00778901,0.124614,0.301269,-2.07006e-08,-0.32268,0.173731,-2.06578e-11,-7.32824e-09,-0.162929,-0.0899904,-5.92126e-10,0.102948,2.38057e-13,-2.7006e-14 };

const float f6_2_weight[] = { 2.2088e-23,-9.07433e-22,-1.8023e-21,1.45614e-22,2.49384e-21,1.40925e-21,2.17674e-21,3.27547e-21,3.40482e-22,7.5095e-06,4.88088e-06,2.1367e-06,1.82074e-05,4.27542e-06,1.67221e-05,-2.03709e-06,1.45906e-05,4.2069e-05,-3.00163e-11,5.80503e-11,1.16469e-10,9.23926e-11,1.11096e-10,-1.47323e-11,-2.33121e-11,1.78509e-10,1.61833e-10,1.69225e-17,1.93331e-17,-3.30809e-20,2.50342e-17,2.30443e-17,8.79306e-18,1.64376e-17,1.28119e-17,8.89119e-18,4.99101e-05,0.000121248,5.24779e-05,0.000286166,0.000181714,0.000151709,7.21254e-05,-1.25283e-05,4.74063e-06,0.0274867,0.430125,0.342453,0.357904,0.526245,0.0568631,0.295027,0.288218,0.261648,3.39753e-23,1.38327e-22,-2.88837e-23,1.46508e-22,4.46204e-23,1.67936e-23,1.05081e-22,1.11325e-22,1.86427e-22,0.218442,-0.300597,-0.472029,-0.033135,-0.329935,-0.500497,0.229517,-0.526777,-0.671255,1.20249,0.387466,0.328169,-0.835742,-1.15341,-0.467656,-0.290795,0.48993,0.291281,5.20291e-09,1.28928e-09,8.32822e-11,1.10937e-09,6.16498e-09,2.80996e-09,2.81098e-09,7.96711e-09,4.46905e-09,0.162987,0.18412,0.173769,-0.0467424,0.574495,0.496192,0.0446125,0.29114,0.553788,-1.11149e-20,-1.53482e-20,-1.29674e-20,-1.12661e-20,-1.94662e-20,-1.3753e-20,-8.39669e-22,-2.76654e-20,-1.35059e-20,1.23552,2.63952,2.40426,2.188,3.16045,1.7489,-0.539701,-0.32575,-0.682595,0.161965,-0.154543,-0.53433,-0.56965,-0.127489,-0.583262,-0.254301,-0.0757643,-0.0864054,1.00531e-24,9.7394e-25,9.80381e-25,2.84612e-25,6.62098e-26,2.14171e-24,-7.94641e-25,2.15979e-25,-9.15552e-25,1.61862e-20,-1.15642e-19,-2.37211e-20,9.89778e-21,-7.68655e-20,-5.6463e-21,3.48718e-20,-9.22666e-20,-1.04799e-19,0.343268,0.130519,-0.125715,1.35346,0.901572,-0.339435,0.783797,0.834731,0.217709,-0.0803448,-0.625851,-0.803476,0.0218789,-0.603781,-0.293483,0.351344,0.180393,0.402775,0.436471,0.303281,-0.071242,0.345587,0.503585,0.275542,0.384558,0.353439,0.352327,0.226656,-0.0686962,0.196836,0.149765,0.391595,0.707133,-0.1872,0.774689,0.622233,-0.387607,-0.200465,0.403022,-0.256059,0.98543,1.4223,-0.218566,-0.656168,-0.937829,-2.09398e-14,-1.73618e-14,-4.93606e-15,-2.70781e-14,-1.33236e-14,-2.48098e-14,-1.1699e-16,-1.24e-14,8.55347e-15,0.580786,0.326122,0.198531,0.372491,0.470265,0.980197,0.704871,0.122944,0.525808,-0.725977,0.435237,1.61365,0.509569,-0.658864,-0.339186,-0.403772,-0.467455,-0.0402859,3.52143e-21,1.53998e-20,2.10217e-21,1.18456e-20,1.71693e-20,3.85454e-21,1.20467e-20,1.26449e-20,-1.48262e-21,4.83674e-15,1.02876e-14,3.75293e-15,3.58005e-15,8.72256e-15,3.15117e-15,-3.63236e-15,-9.67027e-16,1.03808e-16,-0.143259,0.0878052,-0.22826,0.703253,0.217651,-0.200455,0.774373,0.393055,-0.087604,0.297961,0.528924,0.329282,0.0813243,0.634379,0.476957,0.0901739,0.358429,0.311237,9.42237e-18,4.98733e-18,1.39546e-17,1.59759e-17,1.99536e-17,1.74114e-17,1.67382e-17,-6.07787e-18,1.31437e-17,0.79122,0.275837,0.125197,0.457101,0.784225,0.134326,-0.286341,0.428306,0.430668,-1.37404e-23,-2.92526e-23,-1.49634e-23,8.29263e-24,-1.44932e-23,-1.49129e-23,-7.41383e-24,1.37135e-23,-2.63018e-23,-2.4111e-24,-2.28507e-24,-1.60053e-23,-1.60949e-23,-7.34284e-24,-2.30164e-23,-9.74165e-24,1.64294e-24,-1.34945e-23 };
const float f6_2_bias[] = { -6.65956e-13,-2.29018e-05,5.55097e-07,1.65802e-10,-0.000890562,-0.138917,-3.33355e-13,1.18134,0.280996,4.74345e-06,-0.175759,1.45635e-11,-0.125116,1.10665,-3.14615e-13,-1.75944e-11,0.0689454,0.649134,0.000338495,0.0304482,-0.0909341,2.82394e-08,-0.0522824,0.229664,1.85835e-12,1.10666e-10,0.067082,0.0372363,1.99805e-10,-0.0388112,-4.90938e-13,-2.80309e-13 };

const float f7_1_weight[] = { -1.20521e-12,0.00019945,-4.90247e-07,1.18841e-10,-0.000668659,-0.11326,-6.34966e-14,-0.23725,-0.00351347,-1.35619e-06,-0.0478523,-5.13773e-13,0.0233397,0.094907,-3.19096e-13,2.47739e-11,-0.15835,0.19822,-0.140583,-0.0929623,0.0500015,-5.12418e-10,0.0813185,0.608889,6.18381e-13,-2.52723e-09,-0.075496,-0.067214,-2.35381e-10,-0.254639,5.78837e-13,5.73139e-14,-1.94504e-12,8.92404e-05,3.73494e-07,-2.07065e-10,-0.000299689,0.117088,-1.0621e-13,0.0823371,0.19532,3.52532e-06,0.0672974,-2.41899e-12,-0.00889069,-0.265102,4.78282e-14,1.03105e-11,0.0320955,-0.480939,0.38017,0.0558274,0.0587741,6.01363e-09,-0.00476376,-0.10391,1.94202e-12,2.12054e-09,0.0545274,-0.172246,-1.10539e-10,-0.0805337,-1.24309e-13,-3.70914e-14,-2.06029e-12,-0.000227307,4.19675e-07,5.5772e-11,-0.000657814,0.0291485,1.47036e-13,-0.116957,-0.132198,6.6925e-07,-0.177152,3.07854e-12,0.0164575,0.191213,4.01113e-13,-2.96877e-11,0.0381587,0.0624604,0.173926,0.0882142,0.313449,4.3418e-09,-0.24315,0.171768,1.33882e-12,-8.06677e-10,0.131349,0.443991,-2.7343e-10,-0.239664,6.37253e-13,-2.55503e-13,-1.84944e-12,0.000364079,-5.29822e-07,1.0278e-10,-0.000111349,-0.114771,4.95301e-13,0.035862,0.00682225,-2.43718e-07,0.590645,2.28969e-12,0.0321087,-0.0714677,-3.05539e-13,8.69979e-11,0.0356935,0.00884898,0.163647,-0.166444,-0.123082,6.36653e-10,0.266322,-0.105759,5.0564e-12,-2.08337e-09,-0.0247685,-0.129224,1.22273e-11,0.20672,2.23208e-13,6.89212e-13,1.79898e-13,0.000210073,-7.74242e-07,5.81564e-11,-0.00046538,0.0735392,-1.91772e-13,0.159106,-0.140924,1.82715e-06,0.397741,-7.01617e-12,0.0346446,0.259538,9.35701e-14,5.3162e-11,-0.122609,-0.0693206,-0.093608,-0.00684816,0.0812569,-3.48326e-09,-0.100666,0.0922831,1.97278e-12,-9.27626e-10,-0.233712,0.0747948,-1.24265e-10,0.117729,-1.39057e-13,1.24875e-14,-7.52596e-13,0.000282334,-5.12891e-07,-7.33441e-11,-0.000354428,-0.288921,2.45536e-13,-0.0404006,0.0703894,-5.56625e-07,-0.144306,-8.32927e-12,0.0130766,0.0388439,2.95007e-13,6.51657e-12,-0.0171511,0.129891,-0.0917876,0.11296,-0.0475873,2.51392e-09,-0.197131,0.162826,1.14848e-12,-1.62165e-10,0.152121,-0.0661922,-1.67217e-10,-0.108131,3.10616e-13,2.58564e-13,2.62229e-12,0.000257336,-3.5629e-07,-7.85846e-11,0.00113578,-0.126901,-2.25729e-13,-0.399801,0.19531,4.00942e-06,0.149419,4.51537e-12,-0.0382773,-0.307495,-2.12009e-13,1.11484e-11,-0.313122,-0.192352,0.220399,-0.045217,-0.215067,-1.38258e-09,-0.110286,-0.00864333,-2.93859e-12,6.04692e-09,-0.155793,-0.363252,2.25154e-10,-0.186923,8.48772e-13,-1.76968e-13,-6.27817e-13,4.7572e-05,8.50009e-07,-2.79511e-10,0.000554174,-0.0943281,-1.12039e-12,-0.0433825,-0.332493,4.11464e-06,0.133612,3.31189e-13,0.0889223,0.107651,3.40814e-13,-8.85966e-11,0.0223483,-0.656697,-0.0663566,-0.0727901,0.342873,1.07366e-08,-0.074437,0.126275,9.24338e-13,1.99371e-09,0.438959,0.301723,-1.88273e-10,0.221376,-1.13063e-12,-2.93406e-14,-4.2015e-13,-0.000146731,-2.47103e-07,-8.77154e-11,-0.000253417,0.0500582,-3.47805e-13,-0.0354436,0.0473319,1.29128e-06,-0.127123,9.62636e-13,0.0380958,-0.105023,-1.74616e-13,-6.85615e-12,0.0186669,-0.142253,0.0811269,0.20125,0.00406608,5.27902e-09,0.134698,-0.00141688,-1.08659e-12,9.68367e-11,0.0391142,-0.0356009,-6.78498e-11,-0.0681799,-4.45329e-14,-2.28601e-13,1.73224e-12,-0.000132789,-4.68367e-07,1.10803e-10,-0.000336203,-0.210827,3.69967e-13,-0.0940046,-0.631151,-2.35503e-06,0.373187,-4.43411e-12,0.0326846,-0.228567,-3.06386e-13,-3.63222e-12,0.391185,-0.193047,-0.303362,-0.105282,0.05981,-5.79187e-09,-0.241938,0.0849772,2.8105e-12,-1.22552e-10,0.22033,0.208288,3.98784e-10,0.08578,-4.62422e-13,2.72331e-13,-2.97274e-12,-4.35589e-05,3.17514e-07,-3.66011e-10,-7.84536e-06,0.0810563,-8.50899e-14,0.0559117,0.185213,5.47473e-07,-0.0542333,-9.30702e-12,-0.0618686,-0.158844,4.18178e-13,4.95024e-11,-0.0330156,-0.266142,-0.150358,0.0407785,-0.110223,9.97753e-09,0.214418,0.0201767,-8.65443e-12,-3.92923e-09,0.189137,-0.0367362,-1.90935e-10,0.497278,-8.31959e-14,-8.01763e-13,-1.99298e-12,-0.000267437,7.22877e-07,6.41207e-10,0.000189491,-0.148513,8.69738e-13,0.901916,0.0311329,5.73943e-06,0.0287932,5.64043e-12,0.219454,0.25562,-5.94766e-13,4.75144e-11,-0.00673212,0.024262,0.149654,0.125963,0.120346,-3.03031e-08,-0.178424,0.132369,1.30311e-11,-5.15758e-09,-0.41225,0.0137393,-1.26368e-10,-0.119984,-1.2989e-13,1.43154e-13,1.42733e-12,-1.02033e-05,5.8481e-07,7.89208e-11,-0.000208367,0.309555,-6.98835e-13,0.0120961,-0.0717233,-5.16843e-06,-0.270077,-8.06073e-12,-0.0919949,0.0343372,-2.17748e-13,-4.54831e-11,0.235291,0.0191702,-0.246718,0.312584,-0.134967,6.21036e-09,-0.278328,-0.180571,-2.2218e-12,3.07093e-09,-0.339572,0.377852,1.32059e-10,0.229284,-2.27904e-13,2.66774e-13,-1.12146e-12,-6.7063e-05,7.14632e-07,-1.89463e-10,-0.000701246,0.0311872,4.64323e-13,0.265123,-0.0877489,1.11495e-06,0.00372384,7.03013e-12,0.00946133,-0.131961,-1.49845e-14,1.86784e-11,-0.217219,-0.155089,0.0648449,-0.27022,-0.111839,3.97057e-09,-0.222631,0.189117,-7.33121e-13,-4.64196e-09,-0.0413895,-0.153646,-3.18153e-10,0.262492,-5.96059e-14,-6.8811e-13,-1.98517e-24,1.74661e-23,7.72835e-24,1.39212e-23,-1.31876e-23,-1.1839e-23,1.08226e-23,2.61174e-23,-1.59092e-23,-9.15272e-24,2.81033e-24,1.50136e-23,-1.9592e-23,1.99393e-24,1.35602e-23,-9.3369e-24,1.30337e-23,1.09119e-23,-1.21723e-23,1.2209e-23,7.21945e-24,5.4848e-24,4.41778e-24,-2.06888e-23,6.93267e-24,4.96998e-24,3.67523e-24,-2.41816e-24,-1.26667e-23,-2.48461e-24,1.63677e-24,1.54074e-23,2.43187e-12,0.00019988,-3.19434e-07,-1.25018e-11,-0.000778021,-0.399682,1.41779e-13,0.0167864,0.379507,2.77409e-06,0.251436,3.61161e-12,-0.0173283,0.220124,3.16439e-13,6.66581e-11,0.178472,0.0355972,0.254096,-0.189379,0.097478,-5.85244e-10,-0.0559108,-0.0968179,8.52429e-12,-2.81402e-09,-0.221928,-0.268046,-7.78252e-11,0.212729,-6.48755e-13,-4.02757e-13,1.61712e-12,0.000310952,1.72804e-08,-1.06647e-10,-0.000342208,0.0704191,7.57699e-13,0.105174,0.0232115,-4.81793e-06,0.0738181,1.72968e-12,0.0469624,0.380808,-3.75137e-13,-2.5634e-11,0.0324172,-0.208056,-0.237154,0.135906,-0.176196,-1.01062e-09,0.145989,-0.0483813,3.10822e-12,-1.48031e-09,0.0427314,0.0678941,-1.60983e-10,-0.0305379,-2.70596e-13,2.66232e-14,2.6771e-13,5.48578e-06,3.19647e-07,-1.60268e-10,-7.99768e-05,-0.102188,1.21585e-13,0.160828,-0.343093,1.68612e-06,-0.0537804,2.19858e-12,-0.0402882,-0.127175,-1.40371e-13,3.18369e-11,-0.079822,0.0792867,-0.0247129,-0.0907605,-0.130683,6.34354e-09,0.179147,-0.10598,-3.96772e-12,-2.06256e-09,0.0695556,-0.245731,-1.62108e-10,-0.283765,-3.28883e-13,-1.03621e-13,2.40304e-12,-0.000116904,7.14772e-07,-1.57666e-10,0.000327702,-0.0959738,-4.38282e-13,-0.0605499,-0.134353,2.36671e-06,-0.235697,-7.11485e-12,-0.0280555,-0.496842,6.19036e-14,1.34519e-12,-0.0514352,0.213681,-0.185822,-0.219268,0.0721668,3.88057e-09,0.169098,-0.236545,-3.01364e-12,2.65245e-09,-0.055225,-0.322429,1.87854e-10,-0.164695,-4.73825e-13,-7.1816e-14,-1.31573e-12,0.000153651,-3.00741e-07,-1.55845e-10,-6.50774e-05,-0.0175595,-8.39087e-14,0.0992956,0.051716,-4.06005e-08,0.0497376,2.4097e-12,-0.00136407,0.0767668,-1.39354e-14,-6.48355e-12,-0.113936,0.0990999,0.11628,0.0708565,-0.0855176,1.08822e-09,0.164311,0.322705,-3.26218e-12,5.22935e-10,-0.147729,-0.216101,-2.89555e-11,-0.0875705,4.17128e-13,2.66686e-13,-2.01802e-12,-0.000234968,-3.45089e-07,-6.94373e-11,0.000127367,0.324603,2.74213e-13,-0.0477329,-0.0755895,9.34345e-06,0.0426687,-1.47237e-13,-0.0102278,0.098847,4.59377e-13,3.62261e-11,0.06756,-0.0140547,0.519701,-0.256616,-0.0844595,1.08573e-08,-0.13126,-0.0299405,-5.42397e-13,-4.15047e-10,0.150954,-0.1202,-1.98998e-10,0.0991649,2.48727e-13,-1.97976e-13,-1.18198e-12,5.82643e-05,-5.95281e-08,-2.20211e-10,-0.00031833,0.0988803,-1.35382e-13,-0.232316,0.0492474,3.93958e-06,-0.431211,2.50196e-12,-0.0320641,0.315722,-4.92892e-13,-1.11449e-11,-0.273016,0.151735,0.140264,0.335317,-0.229968,1.18323e-09,0.0346886,-0.254988,-7.49819e-13,2.27782e-09,-0.112527,-0.163629,-9.76376e-11,0.0335215,-1.68714e-13,2.91718e-13,1.31616e-12,-0.000141574,3.52838e-07,-2.49095e-11,0.000307258,0.0931252,-2.85483e-13,0.137111,-0.0906398,-7.38481e-07,0.138768,3.05609e-12,-0.00605828,-0.157533,-1.28928e-13,-1.54873e-11,-0.139687,-0.0700592,0.127184,-0.148871,-0.456233,-6.30178e-09,0.140518,-0.249828,-1.58784e-12,-1.79653e-09,-0.290109,0.20924,-4.06841e-11,-0.256073,-2.70175e-13,-4.65485e-13,1.39305e-12,-5.56841e-05,1.2822e-07,-2.68774e-10,-0.000403442,0.0721442,9.34505e-13,0.260235,-0.128085,-9.76412e-06,0.324226,-1.14292e-11,-0.0267205,-0.154248,-3.36332e-13,-2.43185e-11,0.447086,-0.00859338,-0.649731,0.340806,0.101417,3.96233e-09,-0.0899109,0.0389283,-3.12259e-12,9.39225e-10,-0.00225322,-0.0329768,4.35282e-10,-0.171342,6.56775e-14,2.72666e-13,-1.70904e-12,0.000143547,7.98918e-07,3.56208e-10,-0.000240027,-0.0845303,4.44422e-13,0.266868,0.20018,-1.50783e-06,0.250589,2.71685e-12,0.0387254,0.0683156,-4.02857e-13,4.391e-11,0.0987552,0.112377,-0.462638,0.264468,-0.0828466,-1.67157e-09,0.184858,-0.0161831,1.0855e-11,-4.45099e-09,0.162445,-0.30155,7.35166e-11,0.0890239,1.47893e-13,7.40228e-13,-4.54313e-24,1.2175e-24,7.17963e-24,5.48703e-24,3.02176e-24,-4.5624e-24,-3.60818e-24,4.07972e-24,3.49528e-24,-2.1596e-25,6.9375e-24,-1.93678e-24,-2.54054e-25,2.1368e-24,-3.99945e-24,7.62179e-25,-1.68151e-24,1.02469e-24,3.65378e-24,6.22164e-25,-2.39806e-24,2.65809e-25,6.64924e-24,-3.56656e-25,6.85158e-25,-4.54685e-24,-2.3523e-24,-9.16268e-25,-2.67803e-24,2.76505e-24,1.28641e-24,2.90692e-24,-1.27823e-12,3.60547e-05,-5.68793e-07,-5.77627e-11,0.000533543,0.310133,4.38657e-14,-0.0628351,-0.0358347,1.17381e-06,-0.0377404,-7.79089e-12,0.0355427,0.0290275,-1.07689e-13,-5.14893e-11,0.163503,-0.400429,0.0735227,0.253649,-0.272633,3.75816e-09,0.0620967,-0.113965,-9.43441e-13,3.66866e-09,0.0186467,0.0116059,2.0305e-10,-0.115483,-4.12995e-13,-1.02035e-14,-1.50949e-12,4.59719e-05,-1.68375e-08,-2.03435e-10,0.000722369,0.101257,-5.01137e-13,-0.30727,0.170509,3.58718e-06,0.0243973,9.27887e-12,0.0452196,-0.133506,-3.74203e-14,-5.65425e-11,-0.149581,0.133141,0.169758,-0.0108158,-0.243283,5.77886e-09,-0.291018,0.0392701,5.90583e-13,-4.29503e-09,0.313827,0.0127782,-2.5288e-10,-0.0793458,2.90435e-13,-1.70694e-13,6.03155e-13,-9.30222e-06,-4.74667e-07,7.329e-11,-0.000107689,0.075035,8.12958e-13,0.197581,-0.131977,7.1598e-08,-0.0125256,4.29588e-12,0.0183387,0.18872,1.82078e-13,-2.36815e-11,-0.15218,0.0438605,0.138416,0.0835327,0.0385927,-7.54046e-10,-0.340488,-0.31964,-1.26272e-12,3.71025e-09,0.121564,-0.227637,-1.22678e-11,-0.361847,-2.72774e-13,-5.53178e-14,-4.50751e-18,-8.21303e-16,2.44348e-14,8.83355e-17,-2.00134e-14,-2.14069e-14,9.74601e-19,1.97997e-14,-4.06415e-15,3.58655e-16,-4.34501e-14,-9.45531e-18,-2.15895e-14,-6.93939e-14,-1.1708e-20,-4.91101e-17,-5.4753e-15,4.01367e-14,-4.07285e-15,-4.74331e-14,-2.58651e-14,1.02666e-14,-1.95603e-15,2.05477e-14,-3.77914e-18,3.62682e-15,4.1722e-14,-1.11319e-13,7.0432e-17,-2.95192e-14,5.66396e-20,2.75044e-19,2.74427e-12,0.000222274,-5.22051e-07,-1.24028e-11,-0.000614701,0.0419524,1.09602e-13,-0.42897,-0.0746625,1.85728e-06,0.518653,-3.971e-12,-0.0510122,0.027124,4.07251e-14,-2.32899e-12,-0.0780919,0.0751592,0.133571,0.00522933,0.0703313,4.86107e-09,-0.253618,-0.157773,-3.6373e-12,-2.32892e-09,-0.569188,-0.0675412,-3.01072e-10,-0.151048,-6.30112e-13,3.6955e-13,-1.40856e-21,2.95877e-21,1.40239e-21,-8.16982e-21,8.17957e-22,-3.12435e-21,3.39013e-22,1.30546e-20,-4.23059e-22,-2.03048e-21,-2.18159e-20,-2.32539e-21,-6.6277e-22,4.95547e-21,2.79538e-23,4.97754e-21,-8.73057e-22,-5.76341e-21,9.69538e-21,4.50816e-21,-8.19081e-21,-3.96724e-23,8.54104e-22,4.93469e-21,2.76924e-22,-4.31885e-21,-3.45657e-21,-5.80655e-21,-4.85654e-21,3.5593e-21,-1.69011e-23,-1.28056e-22 };
const float f7_1_bias[] = { -0.0139555,0.205253,-0.116661,-0.141395,-0.0851493,0.155423,0.553706,0.140341,0.338022,0.315171,0.0215416,-0.670609,0.155758,0.213127,-6.50583e-13,-0.307268,-0.0127364,0.445095,0.637904,0.0122704,-0.137284,0.193397,0.352264,-0.131729,-0.1611,-6.61273e-13,0.335228,0.117227,0.0862005,-4.70426e-08,0.233095,-3.33022e-11 };

const float f7_2_weight[] = { 0.318288,0.372138,0.809574,0.198268,0.213155,0.452438,0.44981,0.0710278,-0.0743014,-0.608268,-0.436491,-0.170545,-0.738307,-0.331131,1.29503,0.704733,0.684223,0.0161461,-0.100768,-0.475864,-0.567777,0.0911329,-0.292932,-0.541014,-0.551705,-0.295906,-0.354687,-0.0920649,0.679296,-0.298844,-0.818781,0.955008,-0.469593,-0.641439,-1.17867,1.16927,-1.22106,0.115474,0.981467,-0.408416,-0.251442,0.854634,0.915596,-0.551932,-0.727354,0.0188816,1.33365,0.0093904,0.443061,0.434878,0.386564,1.22666,1.06671,0.391299,-0.810999,-0.810809,-0.176425,0.916432,0.546997,-0.491937,1.03232,1.37756,1.68083,0.0681798,0.450581,-0.0323535,-0.209196,-1.76724,-0.328723,0.496827,0.503751,0.498863,-0.0961884,0.961419,-1.1401,-0.221466,-1.98146,-1.18269,-0.466786,-0.210728,-0.388351,-0.361481,-0.220189,-0.594677,0.573132,1.34758,0.295553,-0.542299,-0.758693,-0.692259,-0.293917,-0.341768,1.15397,-0.818522,-0.975938,0.609574,-0.356544,1.35887,-0.0697035,0.0418113,0.185359,0.743465,1.37458,0.689437,0.642917,0.673441,0.667159,0.945169,-0.0188279,0.423979,0.34087,0.442941,0.687739,0.20174,0.682874,0.702678,0.158413,0.0902979,0.808202,0.0876149,-0.78058,-0.974358,0.140413,-0.238388,-0.736096,-0.34683,-2.76493e-23,-2.58646e-23,-1.57263e-24,-3.78042e-23,1.03451e-23,1.11728e-23,-8.15991e-24,-2.34688e-23,-2.85809e-23,0.489745,-0.0803369,0.972672,-0.4682,-0.026967,0.839928,-0.653141,1.13,0.846418,-1.31251,-0.289038,0.619105,0.222535,0.141793,-0.0261959,0.852555,-0.408611,-1.52881,-0.0997219,0.229349,-1.49841,0.171997,-0.654241,0.0755694,1.08808,0.831547,0.10444,-0.183972,0.202562,0.409729,0.32101,0.371686,0.084152,1.47308,1.20853,0.695571,1.51263,1.88602,-1.94108,0.0737996,-0.237474,-0.176605,0.263711,0.149326,-0.0187037,0.111824,0.476398,0.236565,0.0738982,1.03205,0.215433,-0.169115,-0.620036,-0.768789,-0.44827,-0.989968,0.0358108,-0.962397,0.332085,-0.520005,-0.415131,1.01688,0.479088,-0.307113,-0.323903,0.338095,-0.934965,-0.0387813,0.894746,0.408534,0.747681,0.531402,0.071,-0.149981,-0.0536425,0.178301,0.836202,1.05974,0.00695062,1.42508,0.557591,-0.915194,-0.307218,0.565007,-0.899097,0.288418,0.361956,-0.898668,1.73224,-0.554548,-4.48489e-23,-5.91383e-23,-5.93037e-23,-4.28045e-23,-1.73288e-23,8.11247e-24,-4.46154e-23,2.85788e-23,6.47714e-23,-0.591396,0.226725,0.411963,-0.757273,-0.126114,0.370059,-0.0542332,-0.934189,-0.430803,0.597937,0.587782,-0.37797,-0.0779964,0.0197878,0.614522,0.326551,0.649795,1.20373,0.0280818,1.40898,0.869927,0.576849,-0.379146,-0.450237,0.528671,0.68987,-0.732944,-4.07334e-13,3.86477e-13,8.03885e-13,-3.90152e-13,6.14883e-13,4.94372e-13,-1.57522e-13,1.64308e-14,5.24926e-13,-0.120577,0.214139,0.659286,0.801641,0.684633,0.240152,0.6447,0.638748,0.398987,2.1093e-20,-3.6534e-20,8.9575e-21,1.29016e-19,3.44066e-20,-4.88829e-20,1.04661e-19,1.63409e-19,1.68073e-20 };
const float f7_2_bias[] = { 0.0180441,-0.01926,0.666354,-0.124957,0.120704,-0.642383,-0.337741,-0.181009,1.28768,0.0514874,-0.0954869,-0.32109,-0.364188,0.412771,4.87114e-13,0.0257813,0.575984,0.26743,-0.226289,-0.11999,0.152415,0.369913,-0.0635504,-0.0764393,0.0252284,3.54949e-13,0.637962,-0.435419,-0.0719044,-1.94228e-08,-0.516038,-3.42864e-12 };

const float f8_1_weight[] = { -0.796069,-0.381552,-0.565399,-0.338465,-0.292728,-0.635015,-0.351171,1.15717,-0.696439,0.263255,0.343149,0.332339,0.824561,1.03895,-1.21104e-12,-0.337063,-0.938411,-0.444695,-0.551521,0.0134245,-0.28042,0.00147609,-1.02202,0.677752,-0.344548,8.22301e-13,-0.179041,0.238355,-0.672747,-8.93063e-08,0.194122,5.88947e-11,-0.231342,-0.0591927,0.66674,-0.512058,-0.176711,0.70724,-0.22881,-0.187264,-1.23965,-0.435908,-0.148243,-0.119248,-0.616717,1.15386,6.61859e-13,-0.355155,-1.4099,-0.462815,1.00229,1.6672,0.657379,-0.132502,1.07562,-0.705958,0.686388,-1.11169e-12,-0.0669664,0.819432,-0.693558,1.13074e-07,-0.262911,-3.48545e-11,-0.598429,-0.553018,1.40433,-0.521773,-0.0953609,0.970453,0.299451,0.584816,0.393196,-0.334215,0.73269,-1.30455,-0.541225,-0.182791,5.49597e-13,-0.251606,-0.159081,-0.0568795,0.0417206,0.357595,0.161147,-0.168863,0.132627,0.260956,-0.203408,-2.11209e-13,0.689793,-0.285745,1.2971,2.03983e-08,-0.189018,-2.41976e-11,0.678604,0.0185025,0.349034,0.0860031,0.11393,-1.00158,0.154291,-0.547853,-0.538929,0.00187385,-0.144153,-0.509957,-0.608274,0.275907,-8.91882e-15,0.482574,0.7497,-0.670937,1.97943,-0.24968,-0.072254,0.641365,-0.873417,-0.488547,-0.417849,1.95689e-13,0.0146353,-0.502908,0.593054,2.3392e-07,0.183939,-1.57268e-11,-4.32789e-25,-2.65151e-24,-5.82077e-25,-9.34321e-24,-2.36108e-25,-3.09103e-24,6.60023e-24,8.74949e-25,-6.19033e-24,-3.57365e-24,1.54789e-24,2.60698e-27,1.77786e-24,-4.24955e-24,-6.27636e-24,-9.01543e-24,-4.49924e-24,-6.8e-24,-3.08809e-24,4.13727e-24,-6.39331e-24,-6.60965e-24,4.98572e-24,5.07449e-25,-8.53471e-24,1.35185e-24,-2.78387e-24,7.35506e-24,-4.71863e-24,1.58694e-24,-2.59947e-25,3.30747e-24,1.20401,0.576812,-1.66933,0.00293214,-0.0609603,-0.476702,-0.334475,-0.511263,-0.0986271,0.321875,-0.444077,1.30819,-0.254571,0.289387,-3.41731e-13,-1.10463,0.157891,0.753267,-0.113852,-0.738848,0.563171,-0.449106,-0.0161742,-0.784816,0.897349,-5.69032e-15,0.565861,0.222276,0.145056,2.68581e-09,-1.71206,-8.20419e-11,-0.560193,-0.230799,0.299503,0.184642,0.229868,-0.693364,0.0200028,-0.0980723,-1.06304,1.43753,1.54848,-0.742417,0.516929,0.124253,-1.80011e-12,-0.140895,-0.238037,-0.308457,-0.43244,0.196551,-0.583299,0.339468,-0.260931,1.04556,0.486902,-3.31387e-13,0.199448,-0.111239,-0.0264072,3.8192e-08,-0.552091,-3.03795e-11,0.187663,-0.667742,0.0177384,-0.520591,0.0728264,0.365471,-1.08508,-0.319464,0.712102,0.383325,-0.905576,0.0618747,0.668593,1.09019,-2.28233e-12,-0.652891,0.0999951,0.981343,-0.838775,0.487059,0.724851,0.763188,-1.33314,-1.56476,-1.20349,2.79722e-13,0.706933,1.40171,-1.10054,1.06294e-07,0.810951,1.28304e-10,0.284074,-0.230303,0.124491,-0.473586,1.21462,-0.420341,-1.10205,-0.565524,-0.46125,-0.171283,-0.535022,0.123945,-0.849485,1.50396,2.05731e-12,-0.580535,-0.549294,-0.0424567,-0.111236,-0.170725,1.08604,-0.850872,1.39867,-0.277984,-0.21911,-2.20338e-12,0.448282,-0.380044,0.126889,-1.29163e-07,-1.30622,-1.40867e-11,-0.600962,1.62892,0.501533,-0.454912,-1.30015,0.250893,-0.445147,-0.534166,0.200931,-0.822576,0.718685,-0.492239,0.488834,-0.728599,-8.81225e-13,0.264248,0.493232,0.762208,-0.140924,0.628499,0.260592,0.271918,0.50704,-0.144674,-0.409081,-2.31717e-12,1.53629,-0.214911,0.69503,2.12173e-07,-0.466333,-7.07652e-11,-0.935973,0.354796,-0.0626088,0.0883278,-0.275025,0.382172,0.447289,1.01869,0.329011,-0.146622,-0.0221921,0.208222,-0.581502,0.0741343,1.30581e-12,-0.247827,1.1917,-0.0679059,-0.392144,-0.448039,0.245528,-1.06351,0.658172,0.107074,0.588646,-1.98577e-12,0.280673,1.05654,0.962264,-3.88864e-08,0.475389,5.6861e-11,-8.34472e-24,-8.54017e-24,7.72469e-24,8.61411e-24,-1.82873e-24,8.05513e-26,7.96659e-25,-1.60455e-24,-7.01674e-24,2.46363e-24,-5.07235e-24,-3.2996e-24,3.30097e-24,-8.79727e-24,1.46041e-24,4.52599e-24,4.43281e-24,3.79349e-24,5.23105e-24,7.96748e-25,-4.83954e-26,-1.09323e-24,6.44164e-24,1.16469e-25,8.27843e-24,-2.58364e-24,-1.0897e-23,3.49009e-24,1.11003e-24,-7.56378e-24,-4.51922e-24,5.83429e-24,0.537552,0.0645284,1.36539,1.37461,0.537616,-0.330067,0.139,-0.344195,-0.531989,0.688388,-0.0346042,-0.0928151,0.44819,-0.24106,2.19042e-12,0.264418,-1.55045,-0.576319,0.18026,-0.72943,-1.15591,0.194684,-0.271241,0.732961,-0.853468,-2.12203e-12,-1.42408,-0.142446,-1.05152,3.41348e-08,0.707462,-4.57092e-13,-1.28687,0.383952,-0.445958,-0.189439,-1.29315,0.101217,-0.684125,0.662958,0.39614,-1.09738,0.522274,0.956384,0.226592,0.343549,-1.5471e-14,-0.564658,-0.710692,-1.22011,-0.558852,0.131346,0.712954,0.055715,0.0343536,-0.310066,-0.685302,4.74661e-12,-0.297623,0.557151,0.737821,-8.41642e-08,-0.28233,7.16788e-11,-0.0702334,0.806847,0.145244,0.205406,0.503352,1.08868,0.401991,-0.204937,0.277914,-0.283539,0.392694,0.732327,0.196252,0.0329087,2.34566e-13,-0.325677,0.623875,-0.448628,-0.124351,-0.468347,-0.581795,-0.202984,1.44994,0.457644,0.217573,1.36028e-12,-0.267538,1.05175,-0.338365,-2.41533e-08,0.374267,-6.11756e-11,-2.487e-24,-1.26005e-24,-1.09261e-23,-5.84905e-24,2.10633e-24,-2.73376e-24,-3.62791e-24,6.45007e-24,1.35715e-23,1.85248e-24,4.39961e-24,-2.20777e-24,-1.57428e-24,-1.92506e-24,3.98933e-24,-4.86166e-24,-1.19662e-23,4.68826e-24,-1.06624e-23,2.92788e-25,2.82419e-24,5.63497e-24,1.4565e-23,4.47191e-25,-2.01501e-24,6.76395e-25,-1.28964e-24,-4.11659e-26,7.14719e-24,3.91735e-24,-1.86511e-24,-1.04814e-23,0.277908,-0.807849,-0.038108,0.363413,0.587839,0.558643,-1.20004,0.979889,0.693041,0.380786,-0.440714,-0.0733793,-0.868447,-1.4613,-1.76574e-12,0.211978,-0.409479,-0.16988,-0.253251,-0.670911,-1.38651,0.167679,0.918312,-0.575719,-0.375454,1.43291e-12,-0.754486,0.367784,0.0886372,-7.94452e-08,0.629071,-5.44901e-11,0.0226864,0.354057,-0.297136,0.140356,0.297218,1.65652,-0.47056,-0.322864,-0.566929,-0.46922,0.314645,0.571292,-0.630033,0.116098,-4.4121e-12,-1.26299,0.701196,-1.04167,-0.977927,0.277105,-1.08849,0.296884,0.818898,0.588754,0.146939,-1.06979e-12,-1.30616,-0.214072,1.10068,3.83539e-08,-0.282609,-3.47048e-11,-1.1718,-0.741511,0.478307,-0.938405,-0.960061,-0.282122,-0.335385,0.405632,-0.61806,1.41549,-0.306567,-0.504966,1.25096,1.13732,-5.40687e-13,0.343504,0.938883,-0.428106,-0.345811,0.28085,-0.269826,-0.313879,-0.944912,-0.200104,-0.939312,1.46309e-13,-0.302083,0.354357,-0.0173508,-9.7862e-08,-0.694582,5.61412e-11,0.644533,-0.766267,0.273126,1.06331,0.0255277,0.38714,1.09639,-0.148892,-1.21492,-0.640692,-0.550686,-0.0244279,0.885804,-0.202251,-6.47628e-13,1.35966,-0.451822,-1.70124,0.0299229,-0.844392,0.803928,-0.511257,-0.935338,-0.261046,-0.854711,4.25482e-12,0.441995,-0.873591,0.48735,1.25111e-07,0.804714,-3.72512e-13,2.98319e-24,-2.79066e-24,-4.48882e-24,-2.84159e-24,1.14573e-24,5.63626e-25,-2.12357e-25,9.13873e-25,4.15051e-25,-3.13386e-24,4.62861e-24,-1.23294e-23,6.26738e-24,4.31645e-24,-1.30501e-24,-8.87024e-26,-1.15405e-24,-3.67916e-24,-9.99456e-24,-1.00002e-24,-3.50706e-25,-1.01456e-24,-7.20567e-25,-6.21147e-24,-2.42432e-24,-4.51799e-24,2.51903e-24,3.33531e-25,3.13349e-24,7.69375e-25,4.08477e-24,-9.69452e-25,0.627463,1.10136,-0.978133,0.826831,1.64137,-2.05269,-0.73339,-0.337311,0.196609,-0.394936,-0.81885,0.464055,-0.819394,0.472538,2.3481e-12,-0.666406,0.259751,0.64608,-0.140657,-1.15376,0.303885,-0.362922,-0.56032,-0.441509,0.129267,-2.04562e-12,0.0338799,-1.14489,0.706061,-2.09074e-07,-1.91065,-7.14927e-11,-0.904128,-0.0547479,-0.563257,1.80021,0.565206,-0.083632,1.74586,-0.0653235,0.412896,-0.180699,-0.241518,0.456737,-0.206527,0.0570876,5.65382e-13,-0.462288,-0.51488,-0.0782102,-0.00337235,-0.0215814,0.0121851,2.11649,-0.0401347,-0.347981,0.57917,2.24605e-12,-0.806592,0.177189,1.25348,-9.2837e-08,-1.33701,-9.94142e-13,0.570275,1.04247,0.320859,0.862257,0.199086,0.707686,0.973152,-0.952255,0.815594,-0.911669,0.101482,0.538652,0.217341,-0.383537,1.38637e-12,-0.0699936,-0.703002,-0.330667,-0.191261,0.779993,-0.176741,0.810614,-0.479934,-0.538315,1.3055,4.42486e-14,-1.34719,1.13415,-1.14356,-2.5934e-07,-0.765912,-3.47396e-11,6.2005e-24,-5.09748e-24,5.474e-24,-5.69476e-24,-2.30338e-24,6.99466e-24,3.43368e-24,-4.36412e-24,1.38367e-24,-3.30332e-24,4.15174e-24,-1.96696e-24,2.05754e-25,-9.53044e-26,3.59527e-24,-1.78191e-24,4.63823e-24,8.18276e-25,-9.52001e-24,6.33368e-24,-4.89271e-26,2.39382e-24,1.58819e-24,4.7485e-24,-5.99076e-24,-1.78337e-24,-1.69125e-23,4.56561e-24,2.99778e-24,-1.57786e-24,1.53517e-24,-5.29872e-24,1.04652,-0.218738,0.445946,-0.554604,0.240852,-0.0490156,0.914085,-0.637765,-0.991827,-0.592632,0.686926,-0.90776,-0.34777,-0.746936,1.05043e-12,1.15735,-0.352527,-0.601147,-0.444445,-0.496669,-0.746698,0.836527,0.114421,-0.544313,-1.13236,-7.26581e-13,0.436694,-1.07284,0.33726,-3.89484e-08,-0.0291423,1.1399e-12,8.89283e-25,1.12543e-25,-6.01643e-26,3.19725e-24,2.72233e-24,5.4191e-25,3.6184e-24,4.07495e-24,2.01909e-24,-8.55394e-25,-2.82153e-24,2.10112e-25,-1.30982e-24,2.21799e-24,9.40943e-25,-6.64029e-25,-3.03236e-24,-2.02423e-24,1.38908e-24,-1.19565e-24,1.3056e-24,-1.22948e-24,3.25486e-25,4.9371e-25,3.84574e-24,1.73031e-24,3.17491e-24,-1.41599e-24,-2.6606e-24,-6.50006e-25,-1.45625e-25,3.1436e-24,-1.5623,-0.724989,0.956193,-0.47136,-1.14037,0.657118,-1.0059,0.765483,0.425254,0.0645438,-0.787407,0.81544,0.6973,0.598549,-2.20345e-12,1.12171,-0.0439061,-1.05997,-0.211708,-0.223784,0.19653,0.100288,-0.159973,0.570058,-0.702536,3.96131e-13,-0.611938,1.45874,0.250996,2.57008e-09,-0.768228,4.87154e-11,-1.44843,-1.03144,0.111939,1.76419,-0.288512,-0.118666,1.40834,-0.1684,1.18447,0.509528,1.33157,0.735972,-0.44745,-0.218444,4.30679e-13,0.910658,-0.762783,0.265629,0.0275136,-1.30273,1.48562,-1.02997,-0.228151,-0.100765,1.00024,-2.30992e-12,0.0187467,1.14358,0.420475,9.0971e-08,0.822521,-2.29119e-11,1.32461,-0.821603,1.25251,-0.891841,0.981527,-0.0650237,-0.601834,1.50378,0.452288,0.0740442,0.785242,-2.39388,-0.136717,-0.866004,2.08447e-12,0.333114,-0.670285,1.20407,-0.0170135,-0.743203,-1.09025,-0.622777,0.772629,1.61442,-1.09493,-8.40996e-13,-0.221426,-0.0744307,0.310547,7.05894e-08,0.948344,1.60586e-11,0.473145,-0.361196,-0.748943,0.315508,0.579651,-0.861918,-0.437398,1.09268,-0.211814,0.191195,-0.265041,-0.589111,-1.63459,-0.711249,2.33318e-13,-0.633634,0.0216841,0.540304,-1.08663,1.13816,-1.19885,0.171667,-0.642653,-0.19221,0.10545,-5.33984e-13,-1.00727,-0.398196,1.26078,-1.39213e-07,-1.68793,1.73181e-11,0.0653216,1.02534,-1.09139,-0.180462,0.536437,-0.26379,-0.403333,0.324063,-0.648227,-0.580405,-1.28033,0.771153,0.83367,-0.729717,-2.69208e-13,0.558006,-0.374671,-0.148831,1.38575,-0.760756,-0.114959,2.01294,-0.0096258,-0.76715,-0.462917,6.8796e-13,0.340475,0.353522,-0.23225,-6.21858e-08,0.45576,1.12873e-10 };
const float f8_1_bias[] = { 1.20021,-0.0935201,-0.447757,-0.0852306,-3.37328e-13,0.424654,0.0817373,-0.173245,0.212232,-1.03979,-0.724467,-3.16283e-13,0.816806,0.928951,-0.866645,-3.16607e-13,0.98244,0.624902,0.675831,0.508101,-3.86551e-13,0.740731,-0.208021,-0.0957992,-4.19198e-13,0.341719,-3.15094e-13,0.270979,-0.717409,-0.4172,1.68679,0.0409551 };

const float f8_2_weight[] = { 0.118048,-0.0237638,0.0300348,0.431305,-0.601468,-0.339201,0.147994,-0.294648,-0.127677,-0.16363,-0.0380726,-0.00876118,-0.353547,0.354346,0.778611,-0.129721,0.257862,-0.282687,-0.0923541,0.190784,-0.110057,-0.204059,-0.537074,0.100161,0.0474387,0.0122494,-0.0939684,-0.154913,-0.319293,0.138872,-0.196267,0.205148,-0.0611098,-0.268924,-0.365639,-0.28127,8.46012e-13,-3.49379e-13,1.51242e-13,6.07967e-14,-2.91981e-13,7.53567e-13,-3.76613e-13,-5.55124e-13,-1.62611e-14,-0.132652,0.107019,0.328744,0.101544,-0.0956052,0.658168,-0.224881,0.00472825,0.243823,0.0842716,0.173345,-0.261697,0.051632,-0.568253,-0.439273,0.244586,0.0171843,0.380328,0.455845,0.330406,-0.131742,0.178852,0.508547,0.179483,-0.00762201,-0.584354,-0.234093,-0.236775,0.0150473,-0.0610391,0.0320467,0.555202,0.559069,-0.224308,0.341494,0.000366639,-0.268449,0.334407,-0.210198,0.150951,-0.236948,0.0583955,0.0948244,-0.54809,-0.286185,0.27033,0.100532,-0.254058,0.0211916,-0.45708,-0.293419,0.220787,0.0469702,0.384409,-1.90794e-13,3.78019e-13,-3.77743e-13,-2.97381e-13,3.15989e-13,-6.45844e-13,-4.32029e-13,3.37324e-14,7.25213e-13,-0.254717,-0.217215,0.0273817,0.0142973,-0.583051,-0.181292,0.193893,0.511446,-0.121688,0.117845,-0.204629,0.267561,0.0841082,-0.225453,-0.375859,-0.0935379,0.276779,-0.473299,0.153284,0.159712,-0.260501,0.0580633,0.0997672,-0.0393721,0.0973674,0.458756,0.328499,7.82065e-13,6.78974e-13,2.26614e-13,4.9431e-13,5.45169e-13,-6.30751e-13,-3.94414e-13,-1.07727e-12,4.38042e-13,-0.0615883,-0.233716,0.141253,-0.265847,-0.0545117,-0.302084,-0.0202584,0.337468,0.575981,0.0493977,0.0333009,0.0599361,0.218155,0.154979,0.0214152,0.328438,0.66125,0.176858,0.249883,0.147223,-0.0769897,0.0517205,-0.0647994,-0.865694,-0.194827,-0.181711,0.192843,0.0316987,0.0675678,0.0923241,0.10793,-0.0789214,-0.477231,-0.053847,0.0526574,-0.505646,-9.15568e-13,9.85288e-13,-9.13535e-14,6.42231e-14,6.90666e-13,-1.27265e-12,6.22513e-14,6.22127e-13,3.1702e-13,0.114335,-0.0288617,0.0631796,-0.014671,0.341549,0.607814,-0.1367,-0.108526,0.488768,-0.0987734,-0.591959,0.0258554,-0.167252,0.0155272,-0.0443784,0.389236,0.241631,0.275625,0.103177,-0.151735,0.0284005,0.104886,0.323202,0.33939,0.228125,0.448549,0.156365,1.11689e-13,8.2925e-13,8.71036e-13,3.40193e-13,1.04279e-12,-2.57006e-13,-1.03459e-13,2.82075e-13,-3.55024e-14,-0.1538,0.00199171,-0.0387526,-0.122123,-0.171539,-0.336682,0.0838472,-0.222063,-0.459597,-3.34588e-14,3.48607e-13,7.46483e-13,-7.78135e-13,-2.2383e-13,1.97532e-14,7.7711e-13,6.18303e-13,-1.02582e-13,0.0119989,0.230502,0.267213,-0.172483,0.230599,-0.745629,0.205826,-0.0313932,-0.211498,0.382228,0.181224,0.152152,0.0223257,0.239447,-0.619092,0.183801,0.491028,0.355784,-0.0417824,-0.0255731,-0.13401,-0.057513,-0.63739,-0.48972,0.0883333,0.121083,0.447202,0.148463,-0.0771362,0.0881792,0.0616637,-0.130264,-0.0969941,-0.050735,0.235134,0.780927,-0.0604926,-0.557211,0.086045,0.248389,0.487921,0.27438,0.0998703,-0.36522,-0.0177235 };
const float f8_2_bias[] = { 0 };

Conv_Info conv_Info[] = {
    {1, 8, 3, 3, 2, 1, f0_1_weight, f0_1_bias},
    {1, 8, 3, 3, 1, 1, f0_2_weight, f0_2_bias},
    {8, 8, 1, 1, 1, 0, f1_1_weight, f1_1_bias},
    {1, 8, 3, 3, 1, 1, f1_2_weight, f1_2_bias},
    {8, 12, 1, 1, 1, 0, f2_1_weight, f2_1_bias},
    {1, 12, 3, 3, 2, 1, f2_2_weight, f2_2_bias},
    {12, 12, 1, 1, 1, 0, f3_1_weight, f3_1_bias},
    {1, 12, 3, 3, 1, 1, f3_2_weight, f3_2_bias},
    {12, 16, 1, 1, 1, 0, f4_1_weight, f4_1_bias},
    {1, 16, 3, 3, 2, 1, f4_2_weight, f4_2_bias},
    {16, 16, 1, 1, 1, 0, f5_1_weight, f5_1_bias},
    {1, 16, 3, 3, 1, 1, f5_2_weight, f5_2_bias},
    {16, 32, 1, 1, 1, 0, f6_1_weight, f6_1_bias},
    {1, 32, 3, 3, 2, 1, f6_2_weight, f6_2_bias},
    {32, 32, 1, 1, 1, 0, f7_1_weight, f7_1_bias},
    {1, 32, 3, 3, 2, 1, f7_2_weight, f7_2_bias},
    {32, 32, 1, 1, 1, 0, f8_1_weight, f8_1_bias},
    {32, 1, 3, 3, 1, 0, f8_2_weight, f8_2_bias},
};
int layer_nums = 18;




static float Buffer[12 * 48 * 48];//保存卷积计算的结果
static float im2col_result[9 * 48 * 48]; //保存im2col计算的结果
static float out_data[8 * 48 * 48]; //保存深度卷积计算的结果
static float cpy_data[1];//保存shortcut时的数据
Feature_Map FM;
//U_CHAR resize_img[NewHeight * NewWidth];
//U_CHAR cropimg[480 * 640];


Feature_Map* Sigmoid(Feature_Map* X) {
    int i;
    for (i = 0; i < X->channels * X->height * X->width; i++) {
        X->data[i] = 1.0 / (1 + exp(-X->data[i]));
    }
    return X;
}

Feature_Map* ReLU(Feature_Map* X) {
    int i;
    for (i = 0; i < X->channels * X->height * X->width; i++) {
        if (X->data[i] < 0) X->data[i] = 0;
    }
    return X;
}

Feature_Map* Conv2D_NxN(Feature_Map* X, Conv_Info conv_Info) {
    int i;
    // 卷积后的尺寸计算,这里width_col=width
    int height_col = (X->height + 2 * conv_Info.padding - conv_Info.ksize_h) / conv_Info.stride + 1;
    int width_col = (X->width + 2 * conv_Info.padding - conv_Info.ksize_w) / conv_Info.stride + 1;
    // 卷积核大小：ksize*ksize是一个卷积核的大小，通道数channels
    int channels_col = conv_Info.in_channels * conv_Info.ksize_h * conv_Info.ksize_w;

    int L_row = conv_Info.out_channels, L_col = channels_col, R_row = channels_col, R_col = height_col * width_col;

    im2col_cpu(X->data, X->channels, X->height, X->width, conv_Info.ksize_w,
        conv_Info.ksize_h, conv_Info.stride, conv_Info.padding, im2col_result);
    if (L_row % 4 == 0 && R_col % 4 == 0) {
        MY_MMult_4x4_7(L_row, R_col, L_col, conv_Info.weight, L_col, im2col_result, R_col, Buffer, R_col, conv_Info.bias);
    }
    else {
        gemm_nn(conv_Info.weight, conv_Info.bias, im2col_result, L_row, L_col, R_row, R_col, Buffer);
    }
    X->channels = conv_Info.out_channels;
    X->width = width_col;
    X->height = height_col;
    X->data = Buffer;
    return X;
}

Feature_Map* Conv2D_1x1_MY_MMult_4x4(Feature_Map* X, Conv_Info conv_Info) {
    int i;
    // 卷积核大小：ksize*ksize是一个卷积核的大小，通道数channels
    int channels_col = conv_Info.in_channels * conv_Info.ksize_h * conv_Info.ksize_w;
    int L_row = conv_Info.out_channels, L_col = channels_col, R_row = channels_col, R_col = X->height * X->width;
    //卷积运算
    for (i = 0; i < X->channels * X->height * X->width; i++) im2col_result[i] = X->data[i];
    MY_MMult_4x4_7(L_row, R_col, L_col, conv_Info.weight, L_col, im2col_result, R_col, Buffer, R_col, conv_Info.bias);
    X->channels = conv_Info.out_channels;
    X->data = Buffer;
    return X;
}

Feature_Map* Conv2D_1x1_gemm_nn(Feature_Map* X, Conv_Info conv_Info) {
    int i;
    /// 卷积核大小：ksize*ksize是一个卷积核的大小，通道数channels
    int channels_col = conv_Info.in_channels * conv_Info.ksize_h * conv_Info.ksize_w;
    int L_row = conv_Info.out_channels, L_col = channels_col, R_row = channels_col, R_col = X->height * X->width;
    for (i = 0; i < X->channels * X->height * X->width; i++) im2col_result[i] = X->data[i];
    gemm_nn(conv_Info.weight, conv_Info.bias, im2col_result, L_row, L_col, R_row, R_col, Buffer);
    X->channels = conv_Info.out_channels;
    X->data = Buffer;
    return X;
}

Feature_Map* ConvDepthWise2D_gemm_nn(Feature_Map* X, Conv_Info conv_Info) {

    // 卷积后的尺寸计算,这里width_col=width
    int height_col = (X->height + 2 * conv_Info.padding - conv_Info.ksize_h) / conv_Info.stride + 1;
    int width_col = (X->width + 2 * conv_Info.padding - conv_Info.ksize_w) / conv_Info.stride + 1;
    int channels_col = conv_Info.ksize_h * conv_Info.ksize_w;
    int L_row = 1, L_col = channels_col, R_row = channels_col, R_col = height_col * width_col;
    Feature_Map T;//临时存储特征图的每个通道
    Conv_Info C;//临时存储卷积核的每个通道
    int c = 0, i = 0;
    int imgsize = X->height * X->width;
    int ksize = conv_Info.ksize_h * conv_Info.ksize_w;
    int tem1 = height_col * width_col;
    int tem2 = 0;
    //把每个通道单独拿出来逐通道进行卷积
    for (c = 0; c < X->channels; c++) {

        T.channels = 1;
        T.data = X->data + c * imgsize;
        T.height = X->height;
        T.width = X->width;

        C.bias = conv_Info.bias + c;
        C.in_channels = T.channels;
        C.ksize_h = conv_Info.ksize_h;
        C.ksize_w = conv_Info.ksize_w;
        C.out_channels = 1;
        C.padding = conv_Info.padding;
        C.stride = conv_Info.stride;
        C.weight = conv_Info.weight + c * ksize;

        im2col_cpu(T.data, T.channels, T.height, T.width, C.ksize_w, C.ksize_h,
            C.stride, C.padding, im2col_result);
        gemm_nn(C.weight, C.bias, im2col_result, L_row, L_col, R_row, R_col, Buffer);

        T.channels = C.out_channels;
        T.width = width_col;
        T.height = height_col;
        T.data = Buffer;

        tem2 = c * tem1;
        for (i = 0; i < T.height * T.width; i++) {
            out_data[tem2 + i] = T.data[i];
        }
    }
    X->height = height_col;
    X->width = width_col;
    X->data = out_data;
    return X;
}

void gemm_nn(float* left, float* bias, float* right, int L_row, int L_col, int R_row, int R_col, float* Buffer) {
    //由矩阵相乘，要求L_col=R_row
    int i = 0, j = 0, m = 0, n = 0, k = 0;
    register float tem;
    float* dst, * rightTemp, biasTemp;
    memset(Buffer, 0, L_row * R_col * sizeof(float));
    //for (i = 0; i < L_row * R_col; i++) { result[i] = 0; }
    if (L_col != R_row) return;
    //#pragma omp parallel for
    for (k = 0; k < L_col; k++) { //p表示left的第p列
        n = k * R_col;
        for (i = 0; i < L_row; i++) { //i表示left的第i行
            tem = left[i * L_col + k];
            m = i * R_col;
            dst = Buffer + m;
            rightTemp = right + n;
            for (j = 0; j < R_col; j++) {//j表示right的第j列
                *dst++ += tem * *rightTemp++;
            }
        }
    }
    dst = Buffer;
    //加上偏置
    for (i = 0; i < L_row; i++) {
        biasTemp = *bias++;
        for (j = 0; j < R_col; j++) {
            *dst++ += biasTemp;
        }
    }
}

void AddDot4x4(int k, float* a, int lda, float* b, int ldb, float* c, int ldc) {

    int p;
    register float
        c_00_reg, c_01_reg, c_02_reg, c_03_reg,
        c_10_reg, c_11_reg, c_12_reg, c_13_reg,
        c_20_reg, c_21_reg, c_22_reg, c_23_reg,
        c_30_reg, c_31_reg, c_32_reg, c_33_reg,

        a_0p_reg,
        a_1p_reg,
        a_2p_reg,
        a_3p_reg;
    float
        * b_p0_pntr, * b_p1_pntr, * b_p2_pntr, * b_p3_pntr;

    c_00_reg = 0.0;   c_01_reg = 0.0;   c_02_reg = 0.0;   c_03_reg = 0.0;
    c_10_reg = 0.0;   c_11_reg = 0.0;   c_12_reg = 0.0;   c_13_reg = 0.0;
    c_20_reg = 0.0;   c_21_reg = 0.0;   c_22_reg = 0.0;   c_23_reg = 0.0;
    c_30_reg = 0.0;   c_31_reg = 0.0;   c_32_reg = 0.0;   c_33_reg = 0.0;

    for (p = 0; p < k; p++) {
        a_0p_reg = A(0, p);
        a_1p_reg = A(1, p);
        a_2p_reg = A(2, p);
        a_3p_reg = A(3, p);

        b_p0_pntr = &B(p, 0);
        b_p1_pntr = &B(p, 1);
        b_p2_pntr = &B(p, 2);
        b_p3_pntr = &B(p, 3);

        /* First row */
        c_00_reg += a_0p_reg * *b_p0_pntr;
        c_01_reg += a_0p_reg * *b_p1_pntr;
        c_02_reg += a_0p_reg * *b_p2_pntr;
        c_03_reg += a_0p_reg * *b_p3_pntr;

        /* Second row */
        c_10_reg += a_1p_reg * *b_p0_pntr;
        c_11_reg += a_1p_reg * *b_p1_pntr;
        c_12_reg += a_1p_reg * *b_p2_pntr;
        c_13_reg += a_1p_reg * *b_p3_pntr;

        /* Third row */
        c_20_reg += a_2p_reg * *b_p0_pntr;
        c_21_reg += a_2p_reg * *b_p1_pntr;
        c_22_reg += a_2p_reg * *b_p2_pntr;
        c_23_reg += a_2p_reg * *b_p3_pntr;

        /* Four row */
        c_30_reg += a_3p_reg * *b_p0_pntr++;
        c_31_reg += a_3p_reg * *b_p1_pntr++;
        c_32_reg += a_3p_reg * *b_p2_pntr++;
        c_33_reg += a_3p_reg * *b_p3_pntr++;
    }

    C(0, 0) += c_00_reg;   C(0, 1) += c_01_reg;   C(0, 2) += c_02_reg;   C(0, 3) += c_03_reg;
    C(1, 0) += c_10_reg;   C(1, 1) += c_11_reg;   C(1, 2) += c_12_reg;   C(1, 3) += c_13_reg;
    C(2, 0) += c_20_reg;   C(2, 1) += c_21_reg;   C(2, 2) += c_22_reg;   C(2, 3) += c_23_reg;
    C(3, 0) += c_30_reg;   C(3, 1) += c_31_reg;   C(3, 2) += c_32_reg;   C(3, 3) += c_33_reg;
}

void MY_MMult_4x4_7(int m, int n, int k, float* a, int lda, float* b, int ldb, float* c, int ldc, float* bias) {

    int i, j;
    float* dst = c;
    float biasTem;
    memset(c, 0, m * n * sizeof(float));
    for (j = 0; j < n; j += 4) {        /* Loop over the columns of C, unrolled by 4 */
        for (i = 0; i < m; i += 4) {        /* Loop over the rows of C */
            /* Update C( i,j ), C( i,j+1 ), C( i,j+2 ), and C( i,j+3 ) in
           one routine (four inner products) */

            AddDot4x4(k, &A(i, 0), lda, &B(0, j), ldb, &C(i, j), ldc);
        }
    }
    //加上偏置
    for (i = 0; i < m; i++) {
        biasTem = *bias++;
        for (j = 0; j < n; j++) {
            *dst++ += biasTem;
        }
    }
}

Feature_Map* Concat(Feature_Map* X1, Feature_Map X2) {

    int i = 0;
    for (i = 0; i < X1->channels * X1->height * X1->width; i++) {
        X1->data[i] += X2.data[i];
    }
    return X1;
}

Feature_Map* Bmp2FeatureMap(U_CHAR* img, Feature_Map* X, int height, int width) {

    int i;

    X->channels = 1;

    X->height = height;
    X->width = width;

    for (i = 0; i < X->channels * X->height * X->width; i++) {
        Buffer[i] = img[i] * 1.0 / 255.0;
    }
    X->data = Buffer;

    return X;
}

void im2col_cpu(float* data_im, int channels, int height, int width,
    int ksize_w, int ksize_h, int stride, int pad, float* data_col)
{

    int c, h, w;
    // 卷积后的尺寸计算,这里width_col=width
    int height_col = (height + 2 * pad - ksize_h) / stride + 1;
    int width_col = (width + 2 * pad - ksize_w) / stride + 1;

    int w_offset, h_offset, c_im, w_h_c;
    int im_row, im_col;

    /// 卷积核大小：ksize*ksize是一个卷积核的大小，通道数channels
    int channels_col = channels * ksize_h * ksize_w;
    float* dst = data_col, * src;

    // 获取channels_col个对应像素核
    for (c = 0; c < channels_col; ++c) {
        // 卷积核上的坐标:(w_offset,h_offset)
        w_offset = c % ksize_w;
        h_offset = (c / ksize_w) % ksize_h;

        c_im = c / ksize_h / ksize_w;

        w_h_c = width * height * c_im;

        for (h = 0; h < height_col; ++h) {
            // 内循环等于该层输出图像列数width_col，说明最终得到的data_col总有channels_col行，height_col*width_col列
            im_row = h_offset + h * stride;
            im_row -= pad;
            src = data_im + (long long)width * im_row + w_h_c;

            for (w = 0; w < width_col; ++w) {

                // 获取输入图像的对应像素坐标

                im_col = w_offset + w * stride;

                // 减去补0长度，获取元素真实的行列数

                im_col -= pad;

                // 如果行列数小于0,则返回0（刚好是补0的效果）
                if (im_row < 0 || im_col < 0 || im_row >= height || im_col >= width)
                    *dst++ = 0;
                else
                    *dst++ = *(src + im_col);

            }
        }
    }
}

//U_CHAR* HistogramEqualize(U_CHAR* img, int width, int height) {
//    int i, j;
//    int sum;
//    int DistFrq[256];
//    int	CumDistFrq[256];
//    U_CHAR* src;
//
//    sum = 0;
//    src = img;
//
//    memset(DistFrq, 0, 256 * sizeof(int));
//    memset(CumDistFrq, 0, 256 * sizeof(int));
//
//    for (i = 0; i < height; i++)
//    {
//        for (j = 0; j < width; j++)
//        {
//            DistFrq[*src] += 1;
//            src++;
//        }
//    }
//    for (i = 0; i < 256; i++)
//    {
//
//        sum += DistFrq[i];
//        CumDistFrq[i] = sum;
//        //printf("No.%d ,DistFrq:%d ,CumDistFrq:%d \n", i, DistFrq[i], CumDistFrq[i]);
//
//    }
//
//    src = img;
//    for (i = 0; i < height; i++)
//    {
//        for (j = 0; j < width; j++)
//        {
//            *src = (int)((CumDistFrq[*src] * 255) / sum + 0.5);
//
//            //printf("Row:%d, Col:%d, Cum:%d , Data:%d \n", i, j, CumDistFrq[*src], *src);
//
//            src++;
//        }
//    }
//
//    return img;
//}

//双线性插值法
U_CHAR* ResizeBiLinear(U_CHAR* img, int ori_width, int ori_height, U_CHAR* out, int new_width, int new_height) {
    int len;
    int row, col;
    float x0, y0;

    int x1, y1, x2, y2;
    register int fx1, fx2, fy1, fy2;
    int tem1, tem2;

    register unsigned char* Src00, * Src01, * Src10, * Src11;


    float scl_w, scl_h;

    len = new_width * new_height * (sizeof(U_CHAR));
    memset(out, 0, len);

    scl_w = ((float)ori_width) / ((float)new_width);
    scl_h = ((float)ori_height) / ((float)new_height);


    for (row = 0; row < new_height; row++)
    {
        y0 = row * scl_h;
        y1 = (int)y0;
        y2 = y1 + 1;
        if (y1 == ori_height - 1)    y2 = y1;

        //乘2048是为了将浮点运算转换为定点运算
        fy1 = (y0 - y1) * 2048;
        fy2 = 2048 - fy1;

        tem1 = y1 * ori_width;
        tem2 = y2 * ori_width;

        for (col = 0; col < new_width; col++)
        {
            x0 = col * scl_w;
            x1 = (int)x0;
            x2 = x1 + 1;
            if (x1 == ori_width - 1)    x2 = x1;


            fx1 = (x0 - x1) * 2048;
            fx2 = 2048 - fx1;

            //利用原图上的四个相邻的点计算目标点
            Src00 = img + tem1 + x1;
            Src01 = img + tem2 + x1;
            Src10 = Src00 + 1;
            Src11 = Src01 + 1;

            // 前面乘了2048，现在需要右移22恢复成正确的数据
            *out++ = ((*Src00 * fy2 + *Src01 * fy1) * fx2 + (*Src10 * fy2 + *Src11 * fy1) * fx1) >> 22;

        }
    }

    return out;
}

U_CHAR* ResizeCropBiLinear(U_CHAR* img, int oriWidth, int cropWidth, int cropHeight, U_CHAR* out, int new_width, int new_height) {
    int len;
    int row, col;
    float x0, y0;

    int x1, y1, x2, y2;
    register int fx1, fx2, fy1, fy2;
    int tem1, tem2;

    register unsigned char* Src00, * Src01, * Src10, * Src11;


    float scl_w, scl_h;

    len = new_width * new_height * (sizeof(U_CHAR));
    memset(out, 0, len);

    scl_w = ((float)cropWidth) / ((float)new_width);
    scl_h = ((float)cropHeight) / ((float)new_height);


    for (row = 0; row < new_height; row++)
    {
        y0 = row * scl_h;
        y1 = (int)y0;
        y2 = y1 + 1;
        if (y1 == cropHeight - 1)    y2 = y1;

        //乘2048是为了将浮点运算转换为定点运算
        fy1 = (y0 - y1) * 2048;
        fy2 = 2048 - fy1;

        tem1 = y1 * oriWidth;
        tem2 = y2 * oriWidth;

        for (col = 0; col < new_width; col++)
        {
            x0 = col * scl_w;
            x1 = (int)x0;
            x2 = x1 + 1;
            if (x1 == cropWidth - 1)    x2 = x1;


            fx1 = (x0 - x1) * 2048;
            fx2 = 2048 - fx1;

            //利用原图上的四个相邻的点计算目标点
            Src00 = img + tem1 + x1;
            Src01 = img + tem2 + x1;
            Src10 = Src00 + 1;
            Src11 = Src01 + 1;

            // 前面乘了2048，现在需要右移22恢复成正确的数据
            *out++ = ((*Src00 * fy2 + *Src01 * fy1) * fx2 + (*Src10 * fy2 + *Src11 * fy1) * fx1) >> 22;

        }
    }

    return out;
}

U_CHAR* Filp(U_CHAR* src, int width, int height) {
    int row, col;
    U_CHAR tem;
    int tem1, tem2;

    for (row = 0; row < height / 2; row++) {
        tem1 = row * width;
        tem2 = (height - 1 - row) * width;
        for (col = 0; col < width; col++)
        {
            tem = *(src + tem1 + col);
            *(src + tem1 + col) = *(src + tem2 + col);
            *(src + tem2 + col) = tem;
        }
    }
    return src;
}

int AntiSpoofingNet(Feature_Map* X, Conv_Info* conv_Info, float threshold) {

    int result = 0;

    X = Conv2D_NxN(X, conv_Info[0]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[1]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[2]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[3]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[4]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[5]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[6]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[7]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[8]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[9]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[10]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[11]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[12]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[13]);
    X = ReLU(X);

    X = Conv2D_1x1_MY_MMult_4x4(X, conv_Info[14]);
    X = ReLU(X);
    X = ConvDepthWise2D_gemm_nn(X, conv_Info[15]);
    X = ReLU(X);

    X = Conv2D_1x1_gemm_nn(X, conv_Info[16]);
    X = ReLU(X);
    X = Conv2D_NxN(X, conv_Info[17]);

    X = Sigmoid(X);
    if (X->data[0] > threshold) {
        result = 1;
    }
    else {
        result = 0;
    }
    return result;
}

void FeatureMapCopy(Feature_Map* X1, Feature_Map* X2) {
    int i = 0;

    X2->channels = X1->channels;
    X2->height = X1->height;
    X2->width = X1->width;

    for (i = 0; i < X1->channels * X1->height * X1->width; i++) {
        cpy_data[i] = X1->data[i];

    }
    X2->data = cpy_data;
}

//如果图像未翻转，y_min=height - y_min - box_h
U_CHAR* CropImage(U_CHAR* img, int width, int height, U_CHAR* out, int x_min, int y_min, int box_w, int box_h)
{
    int len;

    int row, col;

    U_CHAR* src;
    U_CHAR* dst;

    int x_max, y_max;

    int x_start, y_start;

    x_start = x_min;

    y_start = y_min;

    box_w = box_w / 4 * 4;

    x_max = x_start + box_w;
    y_max = y_start + box_h;

    len = box_w * box_h * (sizeof(U_CHAR));
    memset(out, 0, len);
    dst = out;

    for (row = y_start; row < (y_max); row++) {
        src = img + (long long)row * width + x_start;
        for (col = x_start; col < (x_max); col++) {
            *dst++ = *src++;
        }
    }
    return out;
}

char AntiSpoofing(U_CHAR* img, int width, int height, int x_min, int y_min, int box_w, int box_h,float threshold) {

    int result;
    int d;

    unsigned char* resize_img = (unsigned char*)(out_data);

    //Filp(img, width, height);
    box_w = box_w / 4 * 4;
    box_h = box_h / 4 * 4;

    if (box_h > box_w) {
        if (box_h > 480) box_h = 480;
        d = box_h - box_w;
        if (x_min + box_w + d / 2 > 480) {
            box_w = box_h;
            x_min = 480 - box_w;
        }
        else {
            box_w = box_h;
            x_min = x_min - d / 2;
            if (x_min < 0) x_min = 0;
        }
    }
    else if (box_w > box_h) {
        d = box_w - box_h;
        if (y_min + box_h + d / 2 > 640) {
            box_h = box_w;
            y_min = 640 - box_h;
        }
        else {
            box_h = box_w;
            y_min = y_min - d / 2;
            if (y_min < 0) y_min = 0;
        }
    }

    //CropImage(img, width, height, cropimg, x_min, y_min, box_w, box_h);
    //ResizeBiLinear(cropimg, box_w, box_h, resize_img, NewWidth, NewHeight);

    ResizeCropBiLinear(img + y_min * width + x_min, width, box_w, box_h, resize_img, NewWidth, NewHeight);

    Bmp2FeatureMap(resize_img, &FM, NewHeight, NewWidth);
    result = AntiSpoofingNet(&FM, conv_Info, threshold);
    printf("score:%.6f\n", FM.data[0]);

    return result;
}

char* getVersion() {
    char* version = "AntiSpoofing_v2.6";
    return version;
}



